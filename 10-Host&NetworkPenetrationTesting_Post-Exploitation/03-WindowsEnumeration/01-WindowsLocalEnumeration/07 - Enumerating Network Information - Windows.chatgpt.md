# Enumerating Network Information – Windows (eJPT) — Study Notes

Note: The transcript is not provided. The following is a conservative, structured summary inferred from the filename and module context (01-WindowsLocalEnumeration). It focuses on standard, built-in Windows techniques to enumerate network information during local post-exploitation or host reconnaissance.

## What the video covers (Introduction / big picture)
- How to enumerate Windows host network information using built-in CMD and PowerShell tools.
- Identifying IPs, interfaces, gateways, DNS servers, routes, neighbors, and name resolution behavior.
- Inspecting active connections and listening services, mapping them to processes.
- Reviewing firewall and proxy configuration that may affect connectivity.
- Extracting Wi-Fi profiles (and keys when possible) and saved network credentials.
- Enumerating domain/workgroup membership, logon server, and network shares.
- Building a quick picture of reachable subnets and nearby hosts for next-step enumeration or pivoting.

## Flow (ordered)
1. Identify interfaces, IPs, masks, gateways, DNS servers, DHCP status.
2. Review routing table and metrics to spot reachable subnets and default route.
3. List ARP/neighbor cache to see recent hosts on the local segment.
4. Review name resolution: DNS cache, DNS client settings, hosts file.
5. Inspect active connections and listening ports; map PIDs to processes.
6. Check firewall profiles and rules; note ports/services potentially blocked/allowed.
7. Check any proxy settings that may affect outbound connectivity.
8. Enumerate Wi-Fi interfaces, profiles, and keys (if possible).
9. Determine domain/workgroup membership, logon server, DCs.
10. List local shares, mapped drives, and discover SMB/NetBIOS info nearby.
11. Optional quick host discovery on the local /24 to find live neighbors.

## Tools highlighted
- CMD: ipconfig, netsh, netstat, arp, route, nslookup, nbtstat, net, tasklist, findstr, type
- PowerShell: Get-NetIPConfiguration, Get-NetAdapter, Get-DnsClientServerAddress, Get-NetRoute, Get-NetTCPConnection, Resolve-DnsName, Test-Connection, Get-Process
- System info helpers: whoami, systeminfo, nltest
- Files/paths: C:\Windows\System32\drivers\etc\hosts
- Optional/older: wmic (legacy), netstat -b (requires admin)
- Credentials/profiles: cmdkey, netsh wlan

## Typical command walkthrough (detailed, copy-paste friendly)

### 1) Interfaces, IP, DNS, DHCP status
CMD:
```
ipconfig /all
netsh interface ip show config
netsh interface ipv4 show interfaces
netsh interface ipv4 show addresses
netsh interface ipv4 show dnsservers
ipconfig /displaydns
```

PowerShell:
```
Get-NetIPConfiguration
Get-NetAdapter | Format-Table -Auto
Get-DnsClientServerAddress | Format-Table -Auto
Get-NetIPInterface | Sort-Object InterfaceMetric | Format-Table -Auto
```

### 2) Routing table and metrics
CMD:
```
route print
route print -4
route print -6
```

PowerShell:
```
Get-NetRoute -AddressFamily IPv4 | Sort-Object -Property RouteMetric | Format-Table -Auto
Get-NetRoute -AddressFamily IPv6 | Sort-Object -Property RouteMetric | Format-Table -Auto
```

### 3) ARP/Neighbor cache
CMD:
```
arp -a
```

PowerShell:
```
Get-NetNeighbor -AddressFamily IPv4 | Where-Object {$_.State -ne "Unreachable"} | Format-Table -Auto
```

### 4) Name resolution behavior and cache
CMD:
```
ipconfig /displaydns
type C:\Windows\System32\drivers\etc\hosts
nslookup example.com
nbtstat -r
nbtstat -c
```

PowerShell:
```
Get-DnsClientGlobalSetting
Resolve-DnsName example.com
```

### 5) Active connections and listeners; map to processes
CMD (non-admin):
```
netstat -ano
netstat -ano | findstr LISTENING
netstat -ano | findstr ESTABLISHED
```
CMD (admin for binaries):
```
netstat -abno
```
Map PID to process:
```
tasklist /fi "PID eq 1234"
```

PowerShell:
```
Get-NetTCPConnection | Sort-Object State,LocalPort | Format-Table -Auto
Get-NetTCPConnection -State Listen | Format-Table -Auto
Get-Process -Id 1234
```

### 6) Windows Firewall status and rules
CMD:
```
netsh advfirewall show allprofiles
netsh advfirewall show currentprofile
netsh advfirewall firewall show rule name=all
```

PowerShell (if available):
```
Get-NetFirewallProfile
Get-NetFirewallRule | Select DisplayName, Enabled, Direction, Action, Profile | Format-Table -Auto
```

### 7) Proxy configuration
CMD:
```
netsh winhttp show proxy
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyEnable
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyServer
```

PowerShell:
```
netsh winhttp show proxy
Get-ItemProperty "HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings" | Select ProxyEnable, ProxyServer
```

### 8) Wi‑Fi interfaces, profiles, and keys (keys require elevated CMD)
CMD:
```
netsh wlan show interfaces
netsh wlan show profiles
netsh wlan show profile name="PROFILE_NAME"
netsh wlan show profile name="PROFILE_NAME" key=clear
```

PowerShell:
```
netsh wlan show interfaces
netsh wlan show profiles
# Keys still via netsh:
# netsh wlan show profile name="PROFILE_NAME" key=clear
```

### 9) Domain/workgroup membership, logon server, DCs
CMD:
```
whoami
whoami /all
echo %USERDOMAIN%
echo %USERDNSDOMAIN%
echo %COMPUTERNAME%
echo %LOGONSERVER%
systeminfo | findstr /B /C:"Domain"
net config workstation
nltest /dsgetdc:%USERDNSDOMAIN%
nltest /dclist:%USERDNSDOMAIN%
```

PowerShell:
```
$env:USERDOMAIN
$env:USERDNSDOMAIN
$env:COMPUTERNAME
$env:LOGONSERVER
(Get-WmiObject Win32_ComputerSystem).Domain
```

### 10) Local shares, mapped drives, NetBIOS/SMB enumeration
CMD:
```
net share
net use
net view
net view /domain
nbtstat -n
nbtstat -A 192.168.1.10
```

PowerShell:
```
Get-SmbShare  # may require admin on local machine; falls back to `net share`
```

### 11) Quick local host discovery (simple ping sweep)
CMD (/24 example; adjust subnet):
```
for /L %i in (1,1,254) do @ping -n 1 -w 80 192.168.1.%i | find "TTL="
```

PowerShell (/24 example; adjust subnet):
```
1..254 | ForEach-Object {
  if (Test-Connection -Count 1 -Quiet 192.168.1.$_) {
    "192.168.1.$_ is up"
  }
}
```

### 12) Misc network-relevant checks
CMD:
```
netsh interface portproxy show all
cmdkey /list
```

PowerShell:
```
netsh interface portproxy show all
cmdkey /list
```

Notes:
- Some commands (netstat -b, Wi-Fi key=clear, Get-SmbShare details) may require an elevated prompt.
- On older/locked-down systems, PowerShell cmdlets may be limited; use CMD/netsh equivalents.

## Practical tips
- Start with ipconfig /all and route print to understand where you are and what you can reach; note default gateway and any extra routes revealing other subnets.
- ARP cache (arp -a) gives you recently contacted hosts on the local segment; use it to prioritize targets.
- Use netstat -ano first (non-admin). If you can elevate, rerun with -b to see binaries. Always map PIDs with tasklist.
- Check firewall profiles; if Domain profile is active, rules differ from Private/Public. This affects lateral movement and bind shells.
- Look for proxies (netsh winhttp, IE proxy in registry). Outbound access may require proxy-aware tools.
- DNS cache (ipconfig /displaydns) leaks recent hostnames (internal portals, DCs, application servers).
- Wi-Fi profiles may expose credentials/passwords for lateral movement when you have admin (key=clear).
- nltest quickly identifies domain controllers and confirms domain membership and logon paths.
- net view and nbtstat help discover SMB exposure and NetBIOS names on LAN.
- Prefer PowerShell Get-Net* cmdlets for structured output and easy filtering/sorting.

## Minimal cheat sheet (one-screen flow)
```
:: Where am I?
ipconfig /all
route print -4
arp -a
ipconfig /displaydns
type C:\Windows\System32\drivers\etc\hosts

:: Ports and processes
netstat -ano
netstat -ano | findstr LISTENING
tasklist /fi "PID eq <PID>"

:: Firewall and proxy
netsh advfirewall show allprofiles
netsh winhttp show proxy
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyServer

:: Wi-Fi
netsh wlan show interfaces
netsh wlan show profiles
:: admin: netsh wlan show profile name="PROFILE" key=clear

:: Domain/workgroup
whoami /all
echo %USERDOMAIN% & echo %USERDNSDOMAIN% & echo %LOGONSERVER%
systeminfo | findstr /B /C:"Domain"
nltest /dsgetdc:%USERDNSDOMAIN%

:: SMB/NetBIOS
net share
net use
net view
nbtstat -n

:: Quick sweep (adjust subnet)
for /L %i in (1,1,254) do @ping -n 1 -w 80 192.168.1.%i | find "TTL="
```

PowerShell equivalents (compact):
```
Get-NetIPConfiguration
Get-NetRoute -AddressFamily IPv4 | sort RouteMetric
Get-NetNeighbor -AddressFamily IPv4
Get-NetTCPConnection -State Listen
Get-Process -Id <PID>
Get-NetFirewallProfile
Get-DnsClientServerAddress
1..254 | % { if (Test-Connection -Count 1 -Quiet 192.168.1.$_) { "192.168.1.$_ up" } }
```

## Summary
This Windows local enumeration segment centers on quickly building a network situational awareness baseline using built-in tools. Start by capturing interface/DNS/DHCP data and routing information, then enumerate neighbors and name resolution artifacts. Identify listening services and active outbound connections, mapping to processes. Check firewall and proxy configurations that influence reachability. Extract wireless profiles and domain/workgroup details for potential lateral paths. Finally, enumerate local shares and perform a quick sweep of the local subnet to discover nearby hosts. These steps provide the foundation to plan further enumeration and exploitation in eJPT-style engagements.