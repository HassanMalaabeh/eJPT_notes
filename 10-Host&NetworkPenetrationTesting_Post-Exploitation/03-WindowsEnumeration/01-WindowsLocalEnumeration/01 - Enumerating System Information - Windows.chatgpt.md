# 01 – Enumerating System Information – Windows (eJPT)

Note: No transcript was provided. The content below is inferred conservatively from the filename/context “01-WindowsLocalEnumeration/01 - Enumerating System Information - Windows.mp4” and standard eJPT Windows local enumeration practices.

## What the video covers (Introduction / big picture)
- How to quickly and safely enumerate Windows system information after gaining local access.
- Using only built-in tools (cmd.exe and PowerShell) to gather OS/build, hardware, domain/workgroup, users/groups/privileges, networking, services, patches, installed software, security controls (AV/EDR/firewall), shares, and useful paths.
- Establishing a repeatable baseline that supports privilege escalation and lateral movement decisions in an eJPT workflow.

## Flow (ordered)
1. Identify host and OS: hostname, OS version/build, architecture, uptime, virtualization.
2. Identify current user context: username, integrity level, groups, privileges.
3. Domain/workstation context: domain/workgroup, DCs, GPO info.
4. Security controls: Windows Defender/EDR, firewall, UAC settings, remote access (RDP/WinRM).
5. Networking: interfaces, IP/DNS/gateway, routes, ARP, connections, hosts file, shares.
6. Patch level: hotfixes; Installed software inventory (x64/x86; avoid heavy WMIC product where possible).
7. Users and groups: local users, local admin membership, logged-on/active sessions.
8. Services/processes/tasks/drivers: service configuration, autostart, scheduled tasks, drivers/filters.
9. Filesystem and environment: drives, free space, Program Files, Users, env vars, PATH.
10. Save outputs to disk for review.

## Tools highlighted
- CMD built-ins: hostname, whoami, systeminfo, ver, set, echo, findstr, reg, ipconfig, arp, route, nslookup, netstat, net, schtasks, sc, tasklist, driverquery, fltmc, fsutil, tzutil, wevtutil, cmdkey, qwinsta/query user.
- WMIC (deprecated but commonly present): wmic os/computersystem/cpu/logicaldisk/qfe/service/nic.
- PowerShell: Get-CimInstance/Get-WmiObject, Get-ComputerInfo, Get-Hotfix, Get-Service, Get-Process, Get-ScheduledTask, Get-NetAdapter, Get-NetIPConfiguration, Get-NetFirewallProfile, Get-MpComputerStatus.
- Optional/if present: nltest, winrm.

## Typical command walkthrough (detailed, copy-paste friendly)

CMD quick-start enumeration (filters included to keep output small):

```cmd
REM ========= 0) Prepare output folder =========
set OUT=%TEMP%\win-enum-%COMPUTERNAME%
mkdir "%OUT%" 2>nul

REM ========= 1) Host & OS =========
echo [HOST/OS] > "%OUT%\1-host-os.txt"
hostname >> "%OUT%\1-host-os.txt"
ver >> "%OUT%\1-host-os.txt"
systeminfo >> "%OUT%\1-host-os.txt"
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type" /C:"Domain" /C:"Original Install Date" /C:"System Boot Time" >> "%OUT%\1-host-os.txt"
wmic os get Caption,Version,BuildNumber,OSArchitecture >> "%OUT%\1-host-os.txt"
wmic computersystem get Manufacturer,Model,Name,Domain,DomainRole,NumberOfLogicalProcessors,TotalPhysicalMemory >> "%OUT%\1-host-os.txt"
wmic cpu get Name,NumberOfCores,NumberOfLogicalProcessors >> "%OUT%\1-host-os.txt"
tzutil /g >> "%OUT%\1-host-os.txt"

REM ========= 2) Current user, groups, privileges =========
echo [USER/PRIVS] > "%OUT%\2-user-privs.txt"
whoami >> "%OUT%\2-user-privs.txt"
whoami /all >> "%OUT%\2-user-privs.txt"
whoami /groups >> "%OUT%\2-user-privs.txt"
whoami /priv >> "%OUT%\2-user-privs.txt"
query user >> "%OUT%\2-user-privs.txt" 2>nul
qwinsta >> "%OUT%\2-user-privs.txt" 2>nul
REM Quick admin check: will fail if not admin
net session >> "%OUT%\2-user-privs.txt" 2>nul

REM ========= 3) Domain/workgroup context =========
echo [DOMAIN/WORKGROUP] > "%OUT%\3-domain.txt"
set | findstr /I "USERDOMAIN LOGONSERVER COMPUTERNAME USERNAME" >> "%OUT%\3-domain.txt"
net config workstation >> "%OUT%\3-domain.txt"
gpresult /r /scope computer >> "%OUT%\3-domain.txt" 2>nul
gpresult /r /scope user >> "%OUT%\3-domain.txt" 2>nul
nltest /dsgetdc:%USERDOMAIN% >> "%OUT%\3-domain.txt" 2>nul

REM ========= 4) Security controls (Defender/EDR/Firewall/UAC/RDP/WinRM) =========
echo [SECURITY CONTROLS] > "%OUT%\4-security.txt"
sc query WinDefend >> "%OUT%\4-security.txt" 2>nul
sc query Sense >> "%OUT%\4-security.txt" 2>nul
tasklist | findstr /I "MsMpEng.exe sense" >> "%OUT%\4-security.txt"
netsh advfirewall show allprofiles >> "%OUT%\4-security.txt"
netsh advfirewall firewall show rule name=all status=enabled >> "%OUT%\4-security.txt" 2>nul
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA >> "%OUT%\4-security.txt"
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v ConsentPromptBehaviorAdmin >> "%OUT%\4-security.txt"
reg query "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections >> "%OUT%\4-security.txt"
sc query TermService >> "%OUT%\4-security.txt" 2>nul
sc query WinRM >> "%OUT%\4-security.txt" 2>nul
winrm get winrm/config >> "%OUT%\4-security.txt" 2>nul

REM ========= 5) Networking =========
echo [NETWORK] > "%OUT%\5-network.txt"
ipconfig /all >> "%OUT%\5-network.txt"
route print >> "%OUT%\5-network.txt"
arp -a >> "%OUT%\5-network.txt"
netstat -ano >> "%OUT%\5-network.txt"
nslookup -type=SRV _ldap._tcp.dc._msdcs.%USERDOMAIN% >> "%OUT%\5-network.txt" 2>nul
type C:\Windows\System32\drivers\etc\hosts >> "%OUT%\5-network.txt" 2>nul
net share >> "%OUT%\5-network.txt"
net use >> "%OUT%\5-network.txt"
net view \\%COMPUTERNAME% /all >> "%OUT%\5-network.txt" 2>nul
net view /domain >> "%OUT%\5-network.txt" 2>nul

REM ========= 6) Patches & Installed software =========
echo [PATCHES] > "%OUT%\6-patches-software.txt"
wmic qfe get HotFixID,Description,InstalledOn >> "%OUT%\6-patches-software.txt"
echo [INSTALLED SOFTWARE x64 HKLM] >> "%OUT%\6-patches-software.txt"
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" /s /v DisplayName >> "%OUT%\6-patches-software.txt"
echo [INSTALLED SOFTWARE x86 HKLM] >> "%OUT%\6-patches-software.txt"
reg query "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall" /s /v DisplayName >> "%OUT%\6-patches-software.txt"
echo [INSTALLED SOFTWARE HKCU] >> "%OUT%\6-patches-software.txt"
reg query "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" /s /v DisplayName >> "%OUT%\6-patches-software.txt"

REM (Optional: slow/heavy) wmic product get name,version,vendor >> "%OUT%\6-patches-software.txt"

REM ========= 7) Users & groups =========
echo [USERS/GROUPS] > "%OUT%\7-users-groups.txt"
net users >> "%OUT%\7-users-groups.txt"
net localgroup >> "%OUT%\7-users-groups.txt"
net localgroup administrators >> "%OUT%\7-users-groups.txt"
net localgroup "Remote Desktop Users" >> "%OUT%\7-users-groups.txt" 2>nul
cmdkey /list >> "%OUT%\7-users-groups.txt" 2>nul

REM ========= 8) Services, tasks, drivers =========
echo [SERVICES/TASKS/DRIVERS] > "%OUT%\8-services-tasks.txt"
tasklist /v >> "%OUT%\8-services-tasks.txt"
tasklist /svc >> "%OUT%\8-services-tasks.txt"
sc query type= service state= all >> "%OUT%\8-services-tasks.txt"
wmic service get Name,DisplayName,StartMode,State,PathName >> "%OUT%\8-services-tasks.txt"
schtasks /query /fo LIST /v >> "%OUT%\8-services-tasks.txt"
driverquery /v /fo table >> "%OUT%\8-services-tasks.txt"
fltmc filters >> "%OUT%\8-services-tasks.txt" 2>nul

REM ========= 9) Filesystem & environment =========
echo [FILESYSTEM/ENV] > "%OUT%\9-fs-env.txt"
fsutil fsinfo drives >> "%OUT%\9-fs-env.txt"
wmic logicaldisk get DeviceID,FileSystem,FreeSpace,Size,VolumeName >> "%OUT%\9-fs-env.txt"
dir C:\Users >> "%OUT%\9-fs-env.txt"
dir "C:\Program Files" >> "%OUT%\9-fs-env.txt" 2>nul
dir "C:\Program Files (x86)" >> "%OUT%\9-fs-env.txt" 2>nul
echo PATH: %PATH% >> "%OUT%\9-fs-env.txt"
echo TEMP: %TEMP%  TMP: %TMP%  APPDATA: %APPDATA%  LOCALAPPDATA: %LOCALAPPDATA% >> "%OUT%\9-fs-env.txt"
```

PowerShell equivalents/one-liners (run as needed):

```powershell
# Host/OS
Get-ComputerInfo | Select-Object CsName,OsName,OsDisplayVersion,OsVersion,WindowsProductName | Format-List
Get-CimInstance Win32_OperatingSystem | Select Caption,Version,BuildNumber,OSArchitecture,InstallDate,LastBootUpTime
Get-CimInstance Win32_ComputerSystem | Select Manufacturer,Model,Domain,DomainRole,Name,Username,TotalPhysicalMemory
$PSVersionTable.PSVersion

# User/privileges
whoami /all
(Get-Item "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System").GetValue("EnableLUA")

# Domain/DC/GPO
try { nltest /dsgetdc:$env:USERDOMAIN } catch {}
gpresult /r

# Security controls
Get-NetFirewallProfile
Get-Service -Name WinDefend,Sense -ErrorAction SilentlyContinue
try { Get-MpComputerStatus | Select AMServiceEnabled,AntivirusEnabled,RealTimeProtectionEnabled } catch {}
(Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server").fDenyTSConnections
Get-Service -Name TermService,WinRM -ErrorAction SilentlyContinue

# Networking
Get-NetAdapter | Where-Object Status -eq Up | Select Name,InterfaceDescription,MacAddress,Status
Get-NetIPConfiguration
Get-DnsClientServerAddress
Get-NetRoute | Sort-Object DestinationPrefix
Get-NetTCPConnection -State Listen,Established

# Patches & software
Get-Hotfix | Sort-Object InstalledOn | Select HotFixID,Description,InstalledOn
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName,DisplayVersion,Publisher | Where-Object DisplayName
Get-ItemProperty HKLM:\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName,DisplayVersion,Publisher | Where-Object DisplayName

# Users & groups
Get-LocalUser
Get-LocalGroup
Get-LocalGroupMember -Group "Administrators" -ErrorAction SilentlyContinue

# Services/processes/tasks/drivers
Get-Service | Select Name,DisplayName,Status,StartType
Get-Process | Select Name,Id,Path
Get-ScheduledTask | Select TaskName,TaskPath,State
Get-CimInstance Win32_SystemDriver | Select Name,State,PathName
```

## Practical tips
- Prefer built-in tools first to minimize noise: systeminfo, whoami, net, sc, ipconfig, netstat, reg, findstr.
- Filter aggressively with findstr to keep outputs small and readable; redirect to files in %TEMP%.
- wmic product is slow and noisy; prefer registry-based software inventory or PowerShell Get-ItemProperty.
- Key privilege flags for escalation: SeImpersonatePrivilege, SeAssignPrimaryTokenPrivilege, SeBackupPrivilege, SeRestorePrivilege, SeDebugPrivilege.
- Check virtualization (VMware/VirtualBox/KVM) to infer lab context and potential drivers/services.
- For domain-joined hosts, nltest and gpresult can reveal DCs and applied GPOs (proxy, scripts, restrictions).
- If commands are blocked in cmd, try PowerShell equivalents (Get-CimInstance). If PowerShell constrained, fall back to WMIC.
- Note firewall profiles and RDP/WinRM status to plan remote access or pivoting.
- Save and timestamp outputs for later comparison across hosts.

## Minimal cheat sheet (one-screen flow)

```cmd
hostname & ver
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type" /C:"Domain" /C:"System Boot Time"
wmic os get Caption,Version,BuildNumber,OSArchitecture
whoami & whoami /groups & whoami /priv
net session 2>nul
set | findstr /I "USERDOMAIN LOGONSERVER COMPUTERNAME"
net config workstation
nltest /dsgetdc:%USERDOMAIN% 2>nul
sc query WinDefend 2>nul & netsh advfirewall show allprofiles
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA
reg query "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections
ipconfig /all & route print & arp -a
netstat -ano
type C:\Windows\System32\drivers\etc\hosts
net share & net use
wmic qfe get HotFixID,InstalledOn
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" /s /v DisplayName
reg query "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall" /s /v DisplayName
net users & net localgroup administrators
tasklist /svc
sc query type= service state= all
schtasks /query /fo LIST /v
wmic logicaldisk get DeviceID,FileSystem,FreeSpace,Size
```

## Summary
- This video (inferred) introduces a structured, Windows-native local enumeration routine aimed at quickly capturing system facts that inform privilege escalation and lateral movement in eJPT.
- The workflow starts with host/OS/user context, then moves through domain/workgroup, security controls, networking, patch/software inventory, users/groups, services/tasks/drivers, and filesystem/env.
- Emphasis is on built-in tools (cmd/PowerShell/WMIC), minimal noise, and actionable outputs saved for later analysis.