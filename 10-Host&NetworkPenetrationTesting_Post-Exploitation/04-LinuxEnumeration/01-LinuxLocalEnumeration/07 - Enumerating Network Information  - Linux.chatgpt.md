# Enumerating Network Information – Linux (eJPT)

Note: No transcript was provided. The following summary is inferred from the filename/context (“01-LinuxLocalEnumeration/07 - Enumerating Network Information - Linux.mp4”) and standard eJPT Linux local network enumeration practices. Commands and emphasis may differ slightly from the actual video.

## What the video covers (Introduction / big picture)
- How to enumerate network information locally on a Linux host during an internal assessment or post-exploitation foothold.
- Identifying interfaces, IPs, MACs, routes, DNS, open/listening services, active connections, neighbors/ARP, and firewall state.
- Using modern iproute2 tools (ip, ss) with fallbacks (netstat, ifconfig) and common helper tools (nmap, dig/host, lsof).
- Quickly deriving the local subnet for host discovery and identifying potential pivot routes (VPN/tun/tap).
- Reading relevant config files (/etc/resolv.conf, /etc/hosts, netplan/NetworkManager) to understand name resolution and network config.

## Flow (ordered)
1. Identify host/platform basics and current user.
2. Enumerate interfaces, IP addresses (IPv4/IPv6), MACs; detect Wi-Fi/VPN/tunnels.
3. Determine default route, egress interface, and local subnets.
4. Review DNS configuration and local name resolution.
5. Inspect ARP/neighbor cache for nearby hosts.
6. List listening services and active connections with owning processes.
7. Review firewall rules/state (iptables/ufw/firewalld).
8. Optionally validate connectivity (ping, traceroute) and discover hosts on the local subnet (nmap ping sweep).
9. Capture quick indicators of proxies, special routing policies, and config files for persistence.

## Tools highlighted
- Core: ip, ss, ping, traceroute/tracepath, lsof, grep, awk
- Optional/fallback: netstat, ifconfig, route (net-tools), nmcli, resolvectl/systemd-resolve, dig, host, nslookup, nmap, arp/arp-scan, iptables/ufw/firewalld, tcpdump
- Paths/files: 
  - /etc/resolv.conf
  - /etc/hosts
  - /etc/nsswitch.conf
  - /etc/netplan/*.yaml (Ubuntu)
  - /etc/network/interfaces (Debian legacy)
  - /etc/NetworkManager/system-connections/*.nmconnection

## Typical command walkthrough (detailed, copy-paste friendly)
Tip: Many commands benefit from sudo to show process names/ports fully.

```bash
# 0) Optional: make sure handy tools are present
sudo apt update && sudo apt install -y net-tools lsof dnsutils nmap ipcalc traceroute arp-scan

# 1) Host identity and user context
hostname
hostname -I
hostnamectl
whoami; id
uname -a

# 2) Interfaces, IPs, MACs
ip -br link
ip -br a
ip addr show
ip -6 addr show
# Wi-Fi (if applicable)
iw dev 2>/dev/null || true
# Tunnels/VPNs
ip -o link show type tun || true
ip -o link show type tap || true

# 3) Routing and egress
ip route show
ip -6 route show
route -n || true
# Egress interface and chosen source IP to reach the Internet
ip route get 1.1.1.1
# All policy routing rules
ip rule show
# Quick trace to a well-known IP (connectivity + path)
traceroute -n 1.1.1.1 || tracepath -n 1.1.1.1

# 4) DNS configuration and resolution
cat /etc/resolv.conf
resolvectl status 2>/dev/null || systemd-resolve --status 2>/dev/null || true
cat /etc/hosts
cat /etc/nsswitch.conf | grep -E 'hosts|net'
# Test queries
dig +short A example.com
host -t A example.com
nslookup example.com 2>/dev/null || true
# External IP via resolver (if outbound DNS allowed)
dig +short myip.opendns.com @resolver1.opendns.com

# 5) Neighbor/ARP information
ip neigh
arp -an 2>/dev/null || true

# 6) Listening services and active connections
# Modern (preferred)
sudo ss -tulnp
sudo ss -tunap
# Filter listening TCP only
sudo ss -ltnp
# Fallbacks
sudo netstat -tulpen 2>/dev/null || true
sudo lsof -i -P -n

# 7) Firewall overview
sudo iptables -S 2>/dev/null || true
sudo iptables -L -n -v 2>/dev/null || true
sudo ip6tables -S 2>/dev/null || true
sudo ufw status verbose 2>/dev/null || true
sudo firewall-cmd --state 2>/dev/null || true
sudo firewall-cmd --list-all 2>/dev/null || true

# 8) Determine local subnets and discover hosts
# All IPv4 CIDRs on up/global interfaces
ip -o -4 addr show up primary scope global | awk '{print $4}'
# Example: pick the first subnet into a variable
SUBNET=$(ip -o -4 addr show up primary scope global | awk 'NR==1{print $4}')
echo "$SUBNET"
# Ping sweep with nmap (fast host discovery)
[ -n "$SUBNET" ] && nmap -sn -PE -PA21,22,80,443 "$SUBNET"
# Simple bash ping sweep (if nmap unavailable)
NET=$(echo "$SUBNET" | cut -d/ -f1 | awk -F. '{print $1"."$2"."$3}') && for i in $(seq 1 254); do (ping -c1 -W1 $NET.$i >/dev/null && echo "UP: $NET.$i") & done; wait

# 9) Process/port deep dive (examples)
# What’s bound to port 80?
sudo ss -lptn 'sport = :80'
# Which process is talking to a specific remote IP:port?
sudo ss -tunp | grep -F '203.0.113.10:443' || true

# 10) Network manager configs (if applicable)
nmcli dev show 2>/dev/null || true
nmcli con show 2>/dev/null || true
sudo ls -l /etc/NetworkManager/system-connections 2>/dev/null || true

# 11) Legacy/OS-specific configs (if present)
ls -l /etc/netplan 2>/dev/null || true
cat /etc/netplan/*.yaml 2>/dev/null || true
cat /etc/network/interfaces 2>/dev/null || true

# 12) Proxies and environment affecting networking
env | grep -i proxy
grep -Rni proxy /etc/apt/ 2>/dev/null || true

# 13) Optional: quick capture to observe traffic (needs sudo)
# Replace eth0 with actual interface from `ip -br link`
IFACE=$(ip -o -4 route show to default | awk '{print $5}')
sudo tcpdump -i "$IFACE" -nn -c 100 '(tcp port 80 or tcp port 443)' 2>/dev/null || true
```

## Practical tips
- Prefer ip and ss over legacy net-tools (ifconfig/netstat). They’re default on modern distros.
- Always use -n/-nn flags to avoid slow DNS/service name lookups during enumeration.
- Use sudo with ss -p and lsof to see process names and PIDs owning sockets.
- ip route get 1.1.1.1 quickly reveals the egress interface and chosen source IP.
- Identify tunnels early (tun0/tap0/wg0) — they often signal VPNs or pivot paths.
- Distinguish bindings to 0.0.0.0 vs 127.0.0.1 to spot locally accessible vs remotely exposed services.
- Check both IPv4 and IPv6; sometimes services listen on :: but not on 0.0.0.0.
- DNS search domains in /etc/resolv.conf can reveal internal namespaces; use them for host guesses (e.g., web01, db01).
- If nmap is missing, a bash ping sweep or arping/arp-scan can still rapidly identify live hosts on the LAN.
- Snapshot configs: copy /etc/resolv.conf, /etc/hosts, and routing info into your notes for later pivoting.

## Minimal cheat sheet (one-screen flow)
```bash
# Host + interfaces
hostnamectl; whoami; id
ip -br a; ip -br link

# Routes + egress
ip r; ip route get 1.1.1.1; ip rule

# DNS + name resolution
cat /etc/resolv.conf; cat /etc/hosts
resolvectl status 2>/dev/null || true
dig +short myip.opendns.com @resolver1.opendns.com

# Neighbors
ip neigh; arp -an 2>/dev/null || true

# Listening + connections
sudo ss -ltnp; sudo ss -tunap
sudo lsof -i -P -n

# Firewall
sudo iptables -L -n -v 2>/dev/null || sudo ufw status verbose 2>/dev/null || true

# Subnet + discovery
SUBNET=$(ip -o -4 addr show up primary scope global | awk 'NR==1{print $4}'); echo $SUBNET
[ -n "$SUBNET" ] && nmap -sn "$SUBNET"
```

## Summary
This module focuses on Linux local network enumeration: discovering interfaces, IPs/MACs, routes and egress paths, DNS configuration, neighbors, listening services, active connections, and firewall state. Using ip and ss as primary tools, supplemented by lsof, dig/host, nmcli, and nmap for discovery, you can rapidly map the local network context, identify exposed services and potential pivot paths (e.g., tun0), and validate connectivity. The commands above provide a practical, copy-paste workflow for eJPT-style assessments when landing on a Linux host.