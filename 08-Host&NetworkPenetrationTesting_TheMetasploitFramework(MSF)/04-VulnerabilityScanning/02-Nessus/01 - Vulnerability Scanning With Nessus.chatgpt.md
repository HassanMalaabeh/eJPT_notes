# 01 - Vulnerability Scanning With Nessus (eJPT Study Notes)

Note: No transcript was provided. The following summary is inferred conservatively from the filename/context and standard eJPT Nessus workflow.

## What the video covers (Introduction / big picture)
- Installing and starting Nessus (Essentials or Professional) on a lab machine.
- Accessing the Nessus web UI, registering, and updating plugins.
- Creating and launching a vulnerability scan against one or more targets.
- Tuning scan settings (discovery, ports, performance, safe checks).
- Reading results: severities, evidence, CVEs, and exploitability.
- Exporting reports and triaging findings for exploitation in later phases.

## Flow (ordered)
1. Prepare Nessus
   - Install Nessus
   - Start/enable the service
   - Access https://127.0.0.1:8834
   - Register (Nessus Essentials) and allow plugins to update
2. Create a scan
   - New Scan > Basic Network Scan (or Advanced Scan for fine-tuning)
   - Name, Description, Folder
   - Targets: single IP, list, or CIDR
3. Tune settings (Advanced Scan recommended)
   - Discovery: adjust ping checks if ICMP blocked
   - Port Scanning: choose all ports/custom, enable SYN scan, service detection
   - Credentials: optional (SSH/SMB) for authenticated scans
   - Performance: set max hosts/checks for lab speed vs. stability
   - Plugins: keep all enabled unless scoping requires otherwise
   - Safe Checks: usually on (default) to avoid dangerous tests
4. Launch and monitor
   - Start immediately or schedule
   - Watch progress and hosts scanned
5. Analyze results
   - Filter by Severity (Critical/High/Medium)
   - Check Evidence/Plugin Output, CVEs, affected ports/services
   - Filter for “Exploit available” to prioritize
6. Validate and export
   - Manually verify high-impact findings with auxiliary tools (e.g., nmap)
   - Export reports (HTML/CSV/.nessus)
7. Plan next steps
   - Map findings to exploitation modules and proof-of-concept paths

## Tools highlighted
- Nessus Essentials/Professional (Tenable)
- Web browser (to access the UI on port 8834)
- Optional: nmap (for validation of ports/services), ufw/iptables (to allow 8834 locally)

## Typical command walkthrough (detailed, copy-paste friendly)

Linux (Debian/Ubuntu/Kali-like) install from Tenable’s .deb:
```
# 1) Download the appropriate .deb from Tenable (via browser)
# 2) Install the package
sudo dpkg -i ~/Downloads/Nessus-*.deb || sudo apt -f install -y

# 3) Enable and start the service
sudo systemctl enable --now nessusd

# 4) Verify it’s listening on 8834
ss -lntp | grep 8834 || sudo lsof -iTCP:8834 -sTCP:LISTEN

# 5) (Optional) Allow local firewall for web UI
sudo ufw allow 8834/tcp

# 6) Access the UI in your browser (or open from terminal)
xdg-open https://127.0.0.1:8834

# 7) Watch logs if plugin download takes time
sudo tail -f /opt/nessus/var/nessus/logs/nessusd.messages
```

RHEL/CentOS/Fedora using .rpm:
```
# 1) Download the appropriate .rpm from Tenable (via browser)
# 2) Install
sudo rpm -Uvh ~/Downloads/Nessus-*.rpm

# 3) Enable and start
sudo systemctl enable --now nessusd

# 4) Verify
ss -lntp | grep 8834
```

CLI admin tasks (alternative to doing it in the UI):
```
# Add a local Nessus user (older/alt workflow; UI is typical now)
sudo /opt/nessus/sbin/nessuscli adduser

# List users
sudo /opt/nessus/sbin/nessuscli lsuser

# Remove user
sudo /opt/nessus/sbin/nessuscli rmuser <username>
```

Registration/update (often done in the UI; CLI alternative shown cautiously):
```
# Register feed (Nessus Essentials activation code)
sudo /opt/nessus/sbin/nessuscli fetch --register YOUR-ACTIVATION-CODE

# Then allow time for plugins to download via the service
sudo tail -f /opt/nessus/var/nessus/logs/nessusd.messages
```

UI scan creation (concise click-path):
- New Scan > Basic Network Scan (or Advanced Scan)
- Settings:
  - Name: Lab Scan
  - Targets: 10.10.1.0/24 (example)
  - Discovery > Host Discovery: if ICMP blocked, disable ping-only logic or use TCP/ARP
  - Port Scanning:
    - Set to All ports or Custom: T:1-65535,U:53,123,161
    - Scan Type: SYN (faster; typically default when service runs as root)
    - Service Discovery: enabled (probe all ports)
  - Credentials: leave empty for unauthenticated; add SSH/SMB for authenticated
  - Performance: increase “Max simultaneous hosts” and “Max checks per host” moderately in a lab
  - Advanced: Safe Checks = enabled (default)
- Save > Launch

Validating critical results with nmap:
```
# Full TCP port sweep to confirm services
nmap -sS -p- -T4 -Pn 10.10.1.25

# Targeted service/version detection for a host
nmap -sV -sC -p22,80,139,445 -Pn 10.10.1.25
```

Exporting results (UI):
- Open the completed scan > Report/Export > choose HTML, CSV, or .nessus > Download.

## Practical tips
- Always let plugins fully update before the first scan to avoid stale results.
- If hosts do not reply to ping, disable “Ping remote host” or ensure TCP/ARP discovery so live hosts aren’t skipped.
- For lab thoroughness, scan all TCP ports; add minimal UDP (53, 123, 161, 500, 4500). Full UDP is slow.
- Keep Safe Checks on for general-purpose scanning; only enable potentially dangerous tests when you understand the risk and scope allows it.
- Start with Basic Network Scan; switch to Advanced Scan to fine-tune ports, performance, and discovery for speed/coverage trade-offs.
- Triage by severity and “Exploit available” to prioritize practical attack paths for eJPT labs.
- Read the Plugin Output/Evidence carefully—Nessus often provides version strings, PoC details, and remediation, which help both validation and exploitation planning.
- Validate key findings with a second method (e.g., nmap service/version detection) to reduce false positives before exploitation.
- Export reports in CSV for quick grepping/sorting of top targets by severity or by port.
- Respect scope: only scan lab ranges explicitly permitted for your exercise.

## Minimal cheat sheet (one-screen flow)
- Start service:
```
sudo systemctl enable --now nessusd
xdg-open https://127.0.0.1:8834
```
- Register in UI (Nessus Essentials), wait for plugin update.
- New Scan > Advanced Scan
  - Targets: 10.10.1.0/24
  - Discovery: allow TCP/ARP if ICMP blocked
  - Ports: All TCP; UDP minimal (U:53,123,161)
  - Scan Type: SYN; Service Discovery: on
  - Performance: moderate increase for lab
  - Safe Checks: on
- Launch; then filter results:
  - Severity: Critical/High
  - Exploit available: true
- Validate key findings:
```
nmap -sV -sC -p22,80,139,445 -Pn <target>
```
- Export report: HTML/CSV for notes.
- Map findings to exploitation (e.g., MS17-010, outdated FTP/SSH/HTTP services).

## Summary
This module introduces Nessus-driven vulnerability assessment for eJPT labs: get Nessus running, configure and launch network scans, and interpret results to prioritize exploitation. Key takeaways are correct initial setup (service, registration, plugins), appropriate scan tuning (discovery, all-port scanning in labs, safe checks), practical triage (severity and exploitability), and validation via complementary tools like nmap. Use exports to organize targets and move efficiently into exploitation in subsequent phases.