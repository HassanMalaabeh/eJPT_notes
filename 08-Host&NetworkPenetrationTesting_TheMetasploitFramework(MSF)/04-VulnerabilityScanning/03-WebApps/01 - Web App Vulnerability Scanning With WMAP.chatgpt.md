# Web App Vulnerability Scanning With WMAP (eJPT)

Note: The transcript is not provided. The outline and commands below are based on standard WMAP usage in Metasploit for eJPT-style labs. Metasploit/WMAP flags can vary slightly by version; use the built-in help for each wmap_* command to confirm options in your environment.

## What the video covers (Introduction / big picture)
- How to quickly scan a web application for common vulnerabilities using WMAP, Metasploit’s built-in web app assessment plugin.
- The workflow inside msfconsole: load WMAP, add a site and targets/paths, enable appropriate HTTP scanner modules, run the scan, and review results.
- Where WMAP fits: fast, integrated recon and vuln checks leveraging Metasploit’s auxiliary/scanner/http modules. It’s not a full DAST replacement (e.g., OWASP ZAP/Burp), but great for quick coverage and chaining findings with Metasploit modules.

## Flow (ordered)
1. Start msfconsole and load the WMAP plugin.
2. Create/select a workspace to keep results organized.
3. Add the target site (scheme + host[:port]).
4. Add one or more target paths (e.g., /, /login, /admin).
5. Review available modules and enable a sensible set.
6. Run the WMAP scan (foreground or as a background job).
7. Monitor progress and view results (services, notes, vulns, loot).
8. Iterate: refine target paths or module selection and rescan.
9. Follow up manually with specific auxiliary/http modules if needed.

## Tools highlighted
- Metasploit Framework (msfconsole)
- WMAP plugin (Metasploit’s web app scanner)
- Metasploit auxiliary/scanner/http modules (executed by WMAP)
- Optional: db_nmap integration to populate/organize the workspace

## Typical command walkthrough (detailed, copy-paste friendly)
Substitute YOUR_TARGET with the host/IP (and port if non-standard). Run these inside msfconsole. Where uncertain due to version differences, confirm with the built-in help (wmap_<cmd> -h).

Initialize and prepare:
```
msfconsole -q
workspace -a webapps
workspace webapps
help wmap
```

Load WMAP and review command help:
```
load wmap
wmap_sites -h
wmap_targets -h
wmap_modules -h
wmap_run -h
```

(Optional) Discover and record open web services in the workspace:
```
db_nmap -sV -p 80,443,8080,8443 YOUR_TARGET
services -p 80-9000
```

Add the target site (include scheme and port if needed):
```
wmap_sites -a http://YOUR_TARGET
wmap_sites -l
```
Examples:
- For HTTPS on a custom port: `wmap_sites -a https://YOUR_TARGET:8443`
- If you added multiple, note the site IDs from `wmap_sites -l` (some versions let you reference site IDs for target ops).

Add target paths (clear then add):
```
wmap_targets -c
wmap_targets -t http://YOUR_TARGET/
wmap_targets -t http://YOUR_TARGET/login
wmap_targets -t http://YOUR_TARGET/admin
wmap_targets -l
```

List and enable modules:
```
wmap_modules -l
```
Common patterns to enable modules:
- Enable everything WMAP knows about:
```
wmap_modules -e all
```
- Or enable a subset by regex (example, focus on common checks):
```
wmap_modules -e 'auxiliary/scanner/http/.*(dir|robots|headers|methods|trace|title|ssl|sql|xss).*'
```
- Disable noisy modules if needed:
```
wmap_modules -d 'auxiliary/scanner/http/.*brute.*'
```

Run the scan:
- Foreground with enabled modules:
```
wmap_run -e
```
- As a background job (if supported in your version):
```
wmap_run -e -j
jobs -l
```

Review results:
```
vulns
notes -S http
loot
services -p 80,443,8080,8443
```

Iterate:
- Add or remove targets, refine modules, re-run:
```
wmap_targets -t http://YOUR_TARGET/upload
wmap_modules -d 'auxiliary/scanner/http/.*ssl.*'   # example disable
wmap_run -e
```

Manual follow-up (if WMAP flags issues or you want specific checks):
```
use auxiliary/scanner/http/dir_scanner
set RHOSTS YOUR_TARGET
set PATH /           # or set DIRLIST, FILELIST options if applicable
run

use auxiliary/scanner/http/http_put
set RHOSTS YOUR_TARGET
set TARGETURI /
run
```

Save state:
```
save
```

If commands differ in your Metasploit build, get exact switches:
```
wmap_sites -h
wmap_targets -h
wmap_modules -h
wmap_run -h
```

## Practical tips
- Be explicit with scheme and port when adding a site (http vs https; non-standard ports).
- Start small: enable a focused subset of modules first to reduce noise and speed up feedback.
- Curate target paths. Include the root “/” and any dynamic or interesting endpoints (/login, /search, /admin, /api/…).
- Use a dedicated workspace per target; it keeps services, notes, vulns, and loot organized.
- WMAP is dated compared to modern DAST tools; validate findings and complement with Nikto, ffuf/gobuster, and Nmap http-* NSE scripts.
- Check module options: some auxiliary modules need extra parameters (cookies, custom headers, creds). If WMAP misses context, run them manually.
- For HTTPS issues, consider setting SSL/TLS options in modules (SSL=true, VHOST, SNI) when running manually.
- Always verify false positives. Use Burp/ZAP or curl to reproduce.

## Minimal cheat sheet (one-screen flow)
```
msfconsole -q
workspace -a webapps && workspace webapps
load wmap

wmap_sites -a http://YOUR_TARGET
wmap_sites -l

wmap_targets -c
wmap_targets -t http://YOUR_TARGET/
wmap_targets -t http://YOUR_TARGET/login
wmap_targets -l

wmap_modules -l
wmap_modules -e all      # or enable a subset by regex
# wmap_modules -e 'auxiliary/scanner/http/.*(dir|headers|methods|ssl|sql|xss).*'

wmap_run -e              # or: wmap_run -e -j ; jobs -l

vulns
notes -S http
loot
save
```

## Summary
- The video demonstrates using Metasploit’s WMAP to quickly assess web apps: define the site, pick target paths, enable scanning modules, run, and review results in the Metasploit database.
- WMAP leverages auxiliary/scanner/http modules to probe for common misconfigurations and vulnerabilities.
- Use WMAP for rapid coverage and pivoting to Metasploit modules; validate and deepen testing with specialized tools when needed.

Uncertainty note: Because the transcript was not provided, command flags are based on common WMAP usage. Use wmap_* -h in your msfconsole to confirm the exact switches for your version.