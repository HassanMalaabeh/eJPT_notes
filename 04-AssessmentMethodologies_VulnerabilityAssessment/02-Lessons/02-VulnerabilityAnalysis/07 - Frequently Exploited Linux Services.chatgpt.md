# 07 - Frequently Exploited Linux Services (eJPT) — Summary

Note: No transcript was provided. The following notes are inferred conservatively from the filename and the eJPT “Vulnerability Analysis” module. Commands and techniques focus on safe, common service enumeration and typical misconfigurations seen on Linux targets.

## What the video covers (Introduction / big picture)
- How to discover and enumerate Linux network services that are commonly misconfigured or vulnerable.
- Tactics to move from “open port” to “actionable finding” (leaked files, creds, shells).
- Service-specific checks for:
  - FTP, SSH, Telnet, SMTP, DNS, SMB/Samba, NFS, SNMP, RPC, Rsync
  - Databases/services: MySQL, PostgreSQL, MongoDB, Redis
  - LDAP, TFTP, NTP, Docker API (if present)
- Using Nmap (and NSE scripts) plus native clients to quickly validate issues (anonymous access, default creds, weak auth, dangerous exports).

## Flow (ordered)
1. Host discovery and full-port scan to see everything listening.
2. Service fingerprinting and banner grabbing (find versions, scripts).
3. Prioritize high-probability misconfigs:
   - Anonymous/unauthenticated access (FTP, SMB, Rsync, MongoDB, Redis, LDAP).
   - World-readable exports (NFS).
   - Default creds/weak passwords (SSH, DBs, Telnet).
   - Info leak vectors (SNMP, SMTP).
4. Per-service deep enumeration using native clients and Nmap NSE scripts.
5. Aggregate credentials/files, test logins across services.
6. If allowed, attempt safe exploitation paths (read-only first; avoid destructive writes).
7. Document findings and map to potential privilege escalation or lateral movement.

## Tools highlighted
- Scanning: nmap (NSE scripts), netcat (nc), telnet, curl
- Authentication/Bruteforce (if in-scope): hydra
- Service clients:
  - ftp, curl (ftp://), ssh, smbclient, rpcinfo, showmount, mount
  - snmpwalk/snmpbulkwalk, rsync, redis-cli, mysql, psql, mongosh (or mongo)
  - ldapsearch, dig, tftp/atftp, ntpq, curl (for Docker API)
- Helpers: seclists wordlists (SNMP/credentials), enum4linux-ng/smbmap (optional)

## Typical command walkthrough (detailed, copy-paste friendly)
Set a target env var:
```bash
export TARGET=10.10.10.10
```

1) Fast discovery and service fingerprinting
```bash
# Full TCP port sweep + service detection + default scripts
sudo nmap -Pn -sS -sV -sC -O -p- --min-rate 2000 -vv $TARGET -oN nmap_full.txt

# Quick top UDP ports (adjust as needed)
sudo nmap -Pn -sU --top-ports 50 -sV $TARGET -oN nmap_udp_top50.txt
```

2) FTP (21/tcp)
```bash
# NSE checks
nmap -Pn -p21 --script ftp-anon,ftp-syst,ftp-bounce $TARGET -oN nmap_ftp.txt

# Test anonymous list with curl (non-interactive)
curl -v ftp://$TARGET/ --user anonymous:anonymous

# Interactive ftp if needed
ftp $TARGET
# Username: anonymous  Password: anonymous@ (or blank)

# If write is enabled (be careful): upload/download
# curl -T localfile ftp://$TARGET/path/ --user anonymous:anonymous
```

3) SSH (22/tcp)
```bash
nmap -Pn -p22 --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods $TARGET -oN nmap_ssh.txt

# If password guessing is in-scope:
# hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://$TARGET
```

4) Telnet (23/tcp)
```bash
# Banner/grab
nc -nv $TARGET 23
# Or:
telnet $TARGET 23

# If in-scope:
# hydra -l root -P /usr/share/wordlists/rockyou.txt telnet://$TARGET
```

5) SMTP (25/tcp, 465/587)
```bash
nmap -Pn -p25,465,587 --script smtp-commands,smtp-enum-users,smtp-open-relay $TARGET -oN nmap_smtp.txt

# Manual VRFY/EXPN check (if allowed)
nc -nv $TARGET 25 << 'EOF'
EHLO attacker
VRFY root
VRFY admin
QUIT
EOF
```

6) DNS (53/udp,tcp) — if a domain is known
```bash
# Replace example.com with discovered domain
dig @${TARGET} example.com AXFR
```

7) SMB/Samba (139/445/tcp)
```bash
nmap -Pn -p139,445 --script smb-os-discovery,smb-enum-shares,smb-enum-users $TARGET -oN nmap_smb.txt

# Null session share listing
smbclient -L //$TARGET/ -N

# Connect to a share
smbclient //$TARGET/sharename -N
# Or try creds if you have them:
# smbclient //$TARGET/sharename -U user
```

8) NFS (111/udp,tcp and 2049/tcp)
```bash
# Discover exports
nmap -Pn -p111,2049 --script nfs-showmount $TARGET -oN nmap_nfs.txt
showmount -e $TARGET

# Mount an export (be cautious; read-only unless authorized)
sudo mkdir -p /mnt/nfs
sudo mount -t nfs -o ro,nolock $TARGET:/exportname /mnt/nfs
ls -la /mnt/nfs
sudo umount /mnt/nfs
```

9) SNMP (161/udp)
```bash
# Quick test of "public" v2c
snmpwalk -v2c -c public -t 1 -r 0 $TARGET 1.3.6.1.2.1.1

# Brute test common communities (noisy; throttle if needed)
for c in public private community; do
  snmpwalk -v2c -c "$c" -t 1 -r 0 $TARGET 1.3.6.1.2.1.1 >/dev/null 2>&1 && echo "[+] community: $c"
done

# Deeper info (processes, users, network)
snmpwalk -v2c -c public $TARGET 1.3.6.1.2.1.25.4.2.1      # hrSWRun (processes)
snmpwalk -v2c -c public $TARGET 1.3.6.1.2.1.4.20          # IP addresses
snmpwalk -v2c -c public $TARGET 1.3.6.1.2.1.1             # system info
```

10) RPC (111)
```bash
rpcinfo -p $TARGET
```

11) Rsync (873/tcp)
```bash
# List modules
rsync rsync://$TARGET

# List files in a module
rsync rsync://$TARGET/modulename

# Download a module recursively (read-only)
mkdir -p loot_rsync && rsync -av rsync://$TARGET/modulename/ loot_rsync/
```

12) MySQL (3306/tcp)
```bash
nmap -Pn -p3306 --script mysql-info,mysql-empty-password,mysql-users,mysql-databases $TARGET -oN nmap_mysql.txt

# Try to connect (password prompt)
mysql --host=$TARGET --port=3306 -u root -p -e "SHOW DATABASES;"

# If in-scope brute:
# hydra -l root -P /usr/share/wordlists/rockyou.txt mysql://$TARGET
```

13) PostgreSQL (5432/tcp)
```bash
nmap -Pn -p5432 --script pgsql-info $TARGET -oN nmap_pg.txt

# Try default user
psql -h $TARGET -U postgres -W -c '\l'

# If in-scope brute:
# hydra -l postgres -P /usr/share/wordlists/rockyou.txt postgres://$TARGET
```

14) MongoDB (27017/tcp)
```bash
nmap -Pn -p27017 --script mongodb-info,mongodb-databases $TARGET -oN nmap_mongo.txt

# Modern shell (mongosh). Fallback: mongo
mongosh --host $TARGET --eval 'db.adminCommand({ listDatabases: 1 })'
# If auth disabled, you'll see DBs; else it will error.
```

15) Redis (6379/tcp)
```bash
nmap -Pn -p6379 --script redis-info $TARGET -oN nmap_redis.txt

redis-cli -h $TARGET PING
redis-cli -h $TARGET INFO
redis-cli -h $TARGET CONFIG GET dir
redis-cli -h $TARGET KEYS '*'
```

16) LDAP (389/tcp)
```bash
nmap -Pn -p389 --script "ldap* and not brute" $TARGET -oN nmap_ldap.txt

# Query root DSE for namingContexts
ldapsearch -x -H ldap://$TARGET -b "" -s base namingContexts

# If you learn a base DN (e.g., dc=example,dc=com), enumerate anonymously:
ldapsearch -x -H ldap://$TARGET -b "dc=example,dc=com"
```

17) TFTP (69/udp)
```bash
# Try to pull a known file if you see references (e.g., via SNMP or config leaks)
# Using tftp-hpa:
tftp $TARGET -m binary -c get boot.cfg

# Using atftp:
# atftp --get -l ./boot.cfg -r boot.cfg $TARGET
```

18) NTP (123/udp)
```bash
ntpq -pn $TARGET
# Older servers:
# ntpdc -c monlist $TARGET
```

19) Docker API (2375/tcp) — if exposed without TLS
```bash
curl -s http://$TARGET:2375/version | jq .
# List images/containers (read-only enumeration)
curl -s http://$TARGET:2375/containers/json | jq .
```

## Practical tips
- Always start with read-only enumeration. Avoid uploads, CONFIG changes, or privileged mounts unless explicitly permitted.
- NFS: mount read-only (ro) and use nolock to avoid RPC lock issues. Watch for no_root_squash indications.
- SMB/Samba: Null sessions may expose shares; try both -N and known creds. Respect sensitive paths.
- SNMP: v1/v2c often misconfigured with “public/private”. Walk hrSWRun (processes) for usernames, creds in args, service versions.
- SMTP: VRFY/EXPN can disclose valid users; many servers disable these—log the behavior.
- Databases: Treat credential guessing carefully; prefer NSE scripts and banner/version checks first.
- Redis/Mongo: “Unauthenticated” access is still common in CTFs; INFO and listDatabases are quick tests.
- Docker API: Treat as highly sensitive. Even read-only listing is impactful; avoid starting containers unless allowed.
- Keep a loot directory and timestamped notes for each service. Reuse discovered creds across services.

## Minimal cheat sheet (one-screen flow)
```bash
export TARGET=10.10.10.10

# Scan
sudo nmap -Pn -sS -sV -sC -O -p- --min-rate 2000 $TARGET -oN nmap_full.txt
sudo nmap -Pn -sU --top-ports 50 -sV $TARGET -oN nmap_udp_top50.txt

# FTP
nmap -Pn -p21 --script ftp-anon,ftp-syst $TARGET
curl -v ftp://$TARGET/ --user anonymous:anonymous

# SSH
nmap -Pn -p22 --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods $TARGET

# SMTP
nmap -Pn -p25,465,587 --script smtp-commands,smtp-enum-users $TARGET

# SMB
nmap -Pn -p139,445 --script smb-os-discovery,smb-enum-shares $TARGET
smbclient -L //$TARGET/ -N

# NFS
nmap -Pn -p111,2049 --script nfs-showmount $TARGET
showmount -e $TARGET
sudo mount -t nfs -o ro,nolock $TARGET:/export /mnt/nfs

# SNMP
snmpwalk -v2c -c public $TARGET 1.3.6.1.2.1.1

# RPC
rpcinfo -p $TARGET

# Rsync
rsync rsync://$TARGET
rsync -av rsync://$TARGET/modulename/ ./loot_rsync/

# MySQL
nmap -Pn -p3306 --script mysql-info,mysql-empty-password $TARGET
mysql --host=$TARGET -u root -p -e "SHOW DATABASES;"

# PostgreSQL
nmap -Pn -p5432 --script pgsql-info $TARGET
psql -h $TARGET -U postgres -W -c '\l'

# MongoDB
nmap -Pn -p27017 --script mongodb-info $TARGET
mongosh --host $TARGET --eval 'db.adminCommand({ listDatabases: 1 })'

# Redis
nmap -Pn -p6379 --script redis-info $TARGET
redis-cli -h $TARGET INFO

# LDAP
nmap -Pn -p389 --script "ldap* and not brute" $TARGET
ldapsearch -x -H ldap://$TARGET -b "" -s base namingContexts
```

## Summary
- The “frequently exploited Linux services” workflow is: scan widely, fingerprint precisely, then apply targeted, native enumeration for each service.
- High-yield misconfigs: anonymous/unauthenticated access (FTP/SMB/Rsync/Mongo/Redis/LDAP), weak/default creds (SSH/DBs/Telnet), exposed exports (NFS), and info leaks (SNMP/SMTP).
- Use Nmap NSE to quickly triage; confirm with service clients. Keep actions low-impact and read-only unless scope explicitly allows otherwise.
- Consolidate discovered files and credentials; retry across services to progress toward access or privilege escalation.