# Vulnerability Scanning with Nessus (eJPT Study Notes)

Note: No transcript was provided. The outline below is inferred from the filename/context and standard eJPT workflows with Tenable Nessus. Where specifics could vary by distro/version, I note assumptions and offer conservative commands.

## What the video covers (Introduction / big picture)
- Why and when to use a vulnerability scanner during an internal assessment.
- Installing/starting Nessus, initial registration, and plugin updates.
- Creating and tuning scans (unauthenticated vs authenticated).
- Running scans against lab ranges, reading results, validating findings.
- Exporting/using results to plan exploitation within the eJPT workflow.
- Best practices: scope control, safe checks, performance, and false-positive handling.

## Flow (ordered)
1. Understand scope and get authorization for target range.
2. Start Nessus service and access the web UI.
3. Register Nessus (Essentials/Pro) and allow plugin updates.
4. Create a “Basic Network Scan” policy/template.
5. Configure Targets (IP/CIDR/range), Discovery, Ports, and Performance.
6. Optional: Add credentials for authenticated scans (SSH/SMB).
7. Save and Launch the scan.
8. Monitor progress, then triage results by severity and asset.
9. Drill into plugin output, impacted ports, and remediation notes.
10. Validate key findings with Nmap/manual checks.
11. Export results (HTML/CSV/.nessus) and map to exploitation steps.
12. Iterate: adjust scope/options or add credentials to reduce noise.

## Tools highlighted
- Tenable Nessus (Nessus Essentials/Pro; web UI + nessuscli).
- Systemctl/service management on Linux (to control nessusd).
- Web browser to access https://127.0.0.1:8834/.
- Nmap (to validate findings and confirm service versions).
- Optional: SSH/SMB credentials for authenticated scans.

## Typical command walkthrough (detailed, copy-paste friendly)
Assumptions:
- You’re on Kali/Ubuntu/Debian with Nessus installed at /opt/nessus.
- Use sudo for administrative commands.
- Replace placeholders like <activation_code>, <ip>, <cidr>.

Start/enable Nessus and confirm UI is listening:
```bash
# Start and enable on boot
sudo systemctl enable --now nessusd.service

# Verify status
systemctl status nessusd.service

# Confirm the web UI port is open
ss -lntp | grep 8834
# Expected: LISTEN on 0.0.0.0:8834 or 127.0.0.1:8834
```

Register Nessus and fetch plugins (if not completed in the web wizard):
```bash
# Register using your activation code (Essentials/Pro)
sudo /opt/nessus/sbin/nessuscli fetch --register <activation_code>

# Optional: list users or create a local Nessus UI user (if the wizard was skipped)
sudo /opt/nessus/sbin/nessuscli lsuser
sudo /opt/nessus/sbin/nessuscli mkuser
# Follow prompts to set username/password and role
```

Access the UI and complete setup:
```bash
# Open in a browser (accept the self-signed TLS cert)
# URL:
https://127.0.0.1:8834/
```

Create and run a “Basic Network Scan” (UI steps):
- New Scan -> Basic Network Scan
- Name: Lab Sweep
- Targets: 192.168.56.0/24 (example; use your authorized scope)
- Discovery:
  - Host Discovery: ARP/ICMP (as appropriate to the environment)
- Port Scanning:
  - Port Scan (range): All ports
  - Port Scanners: TCP SYN Scanner, UDP Scanner (optional; slower)
  - Service Discovery: Probe all ports to find services
- Credentials (optional, for authenticated scans):
  - SSH (Linux): username/password or key
  - SMB/WMI (Windows): Administrator-level account or equivalent
- Advanced/Performance:
  - Max simultaneous hosts: 10–20 (tune to lab capacity)
  - Max checks per host: 4–8
  - Safe Checks: Enabled (disable only in a lab if you accept risk)
- Save -> Launch

Validate select findings with Nmap:
```bash
# Quick service/version check on a single host found by Nessus
nmap -sS -sV -p 21,22,80,139,445,3389 <ip>

# Broad port sweep + service detection (time-intensive)
nmap -p- --min-rate 3000 -sS <ip>
nmap -sV -O -p <top_ports_or_list> <ip>
```

Export results (UI):
- Scan -> Report -> Export -> HTML (executive), CSV (vulns by host), .nessus (XML format)

Useful file paths (Linux defaults; may vary):
```bash
# Nessus installation and data
ls /opt/nessus/sbin/nessuscli
ls /opt/nessus/var/nessus/logs/
ls /opt/nessus/var/nessus/plugins/
```

Stop Nessus when done:
```bash
sudo systemctl stop nessusd.service
```

## Practical tips
- Scope control: Only add in-scope IPs/CIDRs; never scan “the whole subnet” unless authorized.
- Start early: Plugin updates and full-port scans take time; kick them off early in an engagement/exam.
- Port coverage: “All ports” catches non-standard services; for speed, scan TCP first, consider selective UDP (top ports).
- Safe checks: Keep “Safe Checks” on unless you’re in a disposable lab and accept potential service instability.
- Authenticated scans: If you have credentials, use them; they drastically reduce false positives and surface patch-level issues.
- Tuning: If you see unstable responses or throttling, reduce concurrency (hosts/checks) and enable “Scan low bandwidth links”.
- Validation: Use Nmap/manual checks to confirm critical/high findings before spending time exploiting.
- Prioritization: Focus on Critical/High with remote code execution, weak auth, or misconfigurations mapped to known exploit paths.
- Exclusions: Add sensitive hosts/services to exclusions if instructed to avoid impact.
- Exports: Keep a CSV for quick filtering and an HTML for reporting; .nessus for re-import/portability.

## Minimal cheat sheet (one-screen flow)
- Start service:
```bash
sudo systemctl enable --now nessusd
```
- Register (if needed):
```bash
sudo /opt/nessus/sbin/nessuscli fetch --register <activation_code>
```
- Open UI:
```text
https://127.0.0.1:8834/
```
- New Scan -> Basic Network Scan
  - Targets: <cidr_or_list>
  - Ports: All ports; TCP SYN (UDP optional)
  - Discovery: ARP/ICMP + Service discovery
  - Credentials: Add SSH/SMB (if available)
  - Advanced: Safe Checks ON; concurrency tuned to lab
- Launch -> Filter by Critical/High -> Drill into plugin output
- Validate with Nmap:
```bash
nmap -sS -sV -p 80,139,445 <ip>
```
- Export: HTML + CSV (+ .nessus)
- Stop service (optional):
```bash
sudo systemctl stop nessusd
```

## Summary
This session walks through using Tenable Nessus to perform vulnerability scanning in an eJPT-style assessment. You start and register Nessus, create a Basic Network Scan, tune discovery and port scanning, optionally add credentials for deeper checks, then run and triage results by severity. Key takeaways: keep Safe Checks enabled unless you’re in a lab, scope your targets precisely, tune performance to your environment, validate important findings with Nmap/manual probes, and export results to guide exploitation and remediation.