# Web App Vulnerability Scanning with WMAP (Metasploit)

Note: No transcript was provided. The following summary is inferred from the filename/context and standard WMAP workflows in Metasploit. Exact flags may vary slightly across Metasploit versions; use each command’s -h/--help inside msfconsole to confirm.

## What the video covers (Introduction / big picture)
- WMAP is Metasploit’s built‑in web application vulnerability scanner plugin.
- It lets you:
  - Define web “sites” and “targets” (URLs/paths).
  - Enumerate content and technologies.
  - Run Metasploit’s HTTP/WEB auxiliary modules against those targets.
  - Review findings and optionally export a report.
- This session likely shows end‑to‑end use: loading WMAP, adding a site/targets, running enumeration/tests, viewing vulnerabilities, and saving results.
- Intended use: authorized testing in labs or engagements; integrates with Metasploit’s database/workspaces.

## Flow (ordered)
1. Start Metasploit and ensure the database is working; optionally create a workspace.
2. Load the WMAP plugin.
3. Add the target site (http/https URL).
4. Add one or more target paths/URLs to scan.
5. Enumerate the site to discover additional targets (spider/directories/fingerprints).
6. Run vulnerability tests against the collected targets.
7. Review and export findings (vulnerabilities).
8. Optional: adjust scope, threads, proxies; rerun selective checks.
9. Clean up or switch workspace.

## Tools highlighted
- Metasploit Framework (msfconsole)
- WMAP plugin:
  - wmap_sites: manage web sites in scope.
  - wmap_targets: manage specific URLs/paths to test.
  - wmap_run: enumerate and run tests.
  - wmap_vulns: list findings.
  - wmap_report (if available in your build): export results.
- Metasploit DB/workspaces (workspace, db_status)
- Optional: Proxies (e.g., Burp/ZAP) via Metasploit’s global Proxies setting
- Spool (Metasploit output logging)

## Typical command walkthrough (detailed, copy‑paste friendly)

Shell: launch Metasploit quietly
```
msfconsole -q
```

Inside msfconsole: verify DB and create a clean workspace
```
db_status
workspace -a webapp-scan
```

Load WMAP
```
load wmap
```

(Optional but recommended) Set global performance and proxy settings
```
setg THREADS 10
# Route HTTP traffic via a local proxy if desired (Burp/ZAP)
# Format: type:host:port;type2:host2:port2
# Example:
# setg Proxies http:127.0.0.1:8080
```

Help for WMAP components (useful to confirm flags in your version)
```
wmap_sites -h
wmap_targets -h
wmap_run -h
wmap_vulns -h
# If present:
wmap_report -h
```

Add a site (protocol matters; use https:// for TLS)
```
wmap_sites -a http://10.10.10.10
# Or:
# wmap_sites -a https://app.internal.local
```

List sites (note the index/ID if needed for deletion)
```
wmap_sites -l
```

Add target URLs/paths to scan (you can add multiple)
```
wmap_targets -t http://10.10.10.10/
wmap_targets -t http://10.10.10.10/login.php
wmap_targets -t http://10.10.10.10/admin/
```

List targets
```
wmap_targets -l
```

Enumerate (discovery/spidering/fingerprints) — this often finds more targets under the site
```
wmap_run -e
```

List targets again to see newly discovered ones
```
wmap_targets -l
```

Run vulnerability tests against current targets
```
wmap_run -t
```

View detected vulnerabilities
```
wmap_vulns -l
```

(Optional) Export a report if supported by your build
```
# Try HTML and/or text
wmap_report -f html -o /tmp/wmap-report.html
wmap_report -f txt  -o /tmp/wmap-report.txt
```

(Optional) Log output with spool if wmap_report is unavailable
```
spool /tmp/msf-wmap.log
wmap_vulns -l
spool off
```

Housekeeping (optional)
```
# Remove a target or site if needed
# wmap_targets -d <target_id>
# wmap_sites   -d <site_id>

# Clear all targets/sites (use with care)
# wmap_targets -c
# wmap_sites   -c
```

Notes:
- Replace IP/host and paths with your actual scope.
- If a command errors or isn’t recognized, run its -h to confirm flags for your msf version.

## Practical tips
- Always use explicit protocol (http vs https) when adding a site; this sets SSL options correctly for modules.
- Start with a small path set (/, /login, /admin) and enumerate first; add tests after you’ve expanded targets to reduce noise.
- Use THREADS judiciously; higher values speed scans but increase noise and risk of rate‑limits/DoS on fragile apps.
- Consider routing via a proxy (setg Proxies) so you can observe/record traffic and apply exclusions.
- WMAP runs Metasploit’s auxiliary HTTP modules. Some are noisy; coordinate with stakeholders and avoid destructive modules in production.
- Validate findings manually; false positives are possible (e.g., reflected inputs, banner‑based CVEs).
- Combine with other tools (Nikto, OWASP ZAP) for better coverage; WMAP is convenient but not exhaustive.
- Keep workspaces per target/client for clean data separation.

## Minimal cheat sheet (one‑screen flow)
```
msfconsole -q
workspace -a webapp-scan
load wmap
setg THREADS 10
# setg Proxies http:127.0.0.1:8080

wmap_sites   -a http://TARGET
wmap_sites   -l
wmap_targets -t http://TARGET/
wmap_targets -t http://TARGET/login.php
wmap_targets -l

wmap_run -e      # enumerate
wmap_targets -l  # review new targets
wmap_run -t      # test

wmap_vulns -l
# wmap_report -f html -o /tmp/wmap-report.html
```

## Summary
- WMAP integrates web app scanning into Metasploit: define sites/targets, enumerate content, and run HTTP auxiliary modules to find common issues.
- Core flow: load plugin → add site → add targets → enumerate → test → review vulns → report/export.
- Use workspaces, threads, and proxies to keep scans organized, efficient, and observable.
- Because WMAP leverages MSF modules, coverage varies; validate results and complement with additional web scanners.