# What the video covers (Introduction / big picture)
Transcript not provided; content inferred conservatively from the filename “04 - Vulnerability Scanning With Nmap Scripts.mp4” in the “01-VulnerabilityScanning” folder.

The video demonstrates how to use Nmap’s Scripting Engine (NSE) to perform vulnerability-oriented scans. It covers:
- Running default and vulnerability script categories against discovered services
- Targeting service-specific vulnerability scripts (HTTP, SMB, FTP, SSL/TLS, RDP, etc.)
- Using script help, categories, arguments, and output options
- Managing NSE scripts and updating the script database
- Practical scanning patterns you can copy for the eJPT workflow

# Flow (ordered)
1. Identify live hosts and open ports (baseline scans).
2. Enumerate services/versions (-sV) and run default scripts (-sC).
3. Run the “vuln” script category broadly against discovered services.
4. Drill down with service-specific vulnerability NSE scripts.
5. Optionally run third‑party NSE like vulners.nse (if installed).
6. Use script help and list NSE scripts to choose focused checks.
7. Save results (-oA) and triage “VULNERABLE” findings.
8. Validate high‑confidence hits and plan exploitation steps.

# Tools highlighted
- Nmap 7.x
- Nmap Scripting Engine (NSE) categories: default, safe, vuln, intrusive, etc.
- NSE management/utilities:
  - nmap --script, --script-args, --script-help, --script-updatedb
  - Script locations: /usr/share/nmap/scripts (system) and ~/.local/share/nmap/scripts (user)
- Optional third‑party NSE (if installed): vulners.nse (maps versions to CVEs via Vulners)

# Typical command walkthrough (detailed, copy-paste friendly)
Replace TARGET with a host/IP, SUBNET with a CIDR (e.g., 192.168.1.0/24), and adjust output filenames/paths as needed.

1) Host discovery (optional if you already know the target)
```bash
# Ping sweep to find live hosts (greppable output -> list)
nmap -sn SUBNET -oG - | awk '/Up$/{print $2}' > live.txt
```

2) Fast TCP sweep (top ports) and full TCP sweep
```bash
# Fast top ports
nmap -F -T4 -n -oA nmap/top-ports TARGET

# Full TCP ports (all 65k)
sudo nmap -p- -T4 -n -oA nmap/full-tcp TARGET
```

3) Service/version enumeration + default scripts (baseline)
```bash
# Use discovered ports from previous step, or rescan all
# -sC runs default scripts; -sV enables version detection
sudo nmap -sC -sV -T4 -n -oA nmap/baseline TARGET
```

4) Broad vulnerability scan with the “vuln” category
```bash
# General vuln sweep (can be noisy; consider focusing ports with -p)
sudo nmap -sV --script=vuln -T4 -n -oA nmap/vuln TARGET
```

5) Targeted vulnerability checks by service
```bash
# SMB (445) — enumerate security posture and vuln checks
# Note: "smb-vuln*" coverage depends on your Nmap version; some older vuln scripts may be absent.
sudo nmap -p445 -sV --script "smb2-security-mode,smb2-time,smb-enum-shares,smb-enum-users,smb-vuln*" -oN nmap/smb.txt TARGET

# FTP (21) — anonymous access and known backdoor
sudo nmap -p21 -sV --script "ftp-anon,ftp-vsftpd-backdoor" -oN nmap/ftp.txt TARGET

# HTTP/HTTPS — enumeration + HTTP vuln scripts
sudo nmap -p80,443,8080,8443 -sV \
  --script "http-title,http-server-header,http-headers,http-methods,http-enum,http-vuln*" \
  -oN nmap/http.txt TARGET

# SSL/TLS — ciphers, certs, Heartbleed
sudo nmap -p443,8443 -sV --script "ssl-enum-ciphers,ssl-cert,ssl-heartbleed" -oN nmap/ssl.txt TARGET

# RDP — known RDP vulnerability and info
sudo nmap -p3389 -sV --script "rdp-vuln-ms12-020,rdp-ntlm-info" -oN nmap/rdp.txt TARGET
```

6) Optional: Use vulners.nse (if installed) to map versions to CVEs
```bash
# Requires vulners.nse in your scripts path
# Filter to CVEs with CVSS >= 7.0
sudo nmap -sV --script vulners --script-args vulners.mincvss=7.0 -oN nmap/vulners.txt TARGET
```

7) UDP (selective) with vulnerability scripts (slower; be targeted)
```bash
# Top UDP ports with vuln category
sudo nmap -sU --top-ports 20 -sV --script=vuln -oN nmap/udp_vuln.txt TARGET
```

8) NSE script help, listing, and DB management
```bash
# Get help for a category or pattern
nmap --script-help vuln
nmap --script-help "http-vuln*"

# List scripts available on disk
ls -1 /usr/share/nmap/scripts/*vuln* 2>/dev/null || true

# After adding/removing scripts, update the DB
sudo nmap --script-updatedb
```

9) Performance/behavior tuning you may find useful
```bash
# Improve version matching for better vuln mapping
sudo nmap -sV --version-intensity 5 -p <ports> TARGET

# Skip host discovery if ICMP/echo is filtered
sudo nmap -Pn -sV --script=vuln -p <ports> TARGET

# Be explicit and fast on big scopes
sudo nmap -sV --script=vuln -p <ports> --max-retries 1 --host-timeout 60s -T4 -n TARGET
```

10) Passing credentials to auth-capable scripts (example: SMB)
```bash
# Some scripts support auth to reduce false positives
sudo nmap -p445 -sV --script "smb-enum-shares,smb-enum-users" \
  --script-args smbusername=USER,smbpassword=PASS -oN nmap/smb_auth.txt TARGET
```

# Practical tips
- Always run -sV before vulnerability scripts: accurate service versions dramatically improve matching and reduce false positives.
- Start broad (vuln category) then pivot to targeted scripts on specific services/ports.
- Be mindful of categories: prefer safe in production; vuln can be intrusive; dos/fuzzer are risky.
- Save everything with -oA; you’ll want plain (-oN), greppable (-oG), and XML (-oX) for later parsing.
- Use nmap --script-help <name> to see required/optional --script-args and whether a script is intrusive.
- Some well-known scripts may be absent in newer Nmap builds. List your local scripts and adjust patterns accordingly.
- Validate “VULNERABLE” findings with a second method (PoC, vendor bulletin) before exploitation.
- Privileged scans (sudo) improve accuracy for some probes and OS fingerprinting.
- For HTTP targets behind WAFs/CDNs, add --script-trace to inspect requests/responses during debugging, and throttle timing if needed.
- On large scopes, chain: discover -> fast top ports -> full ports on interesting hosts -> service/vuln scripts only on open ports.

# Minimal cheat sheet (one-screen flow)
```bash
# 1) Baseline service scan
sudo nmap -sC -sV -T4 -n -oA nmap/baseline TARGET

# 2) Broad vuln category pass
sudo nmap -sV --script=vuln -T4 -n -oA nmap/vuln TARGET

# 3) Focused by service (examples)
sudo nmap -p445 -sV --script "smb2-security-mode,smb2-time,smb-enum-shares,smb-vuln*" -oN nmap/smb.txt TARGET
sudo nmap -p21  -sV --script "ftp-anon,ftp-vsftpd-backdoor" -oN nmap/ftp.txt TARGET
sudo nmap -p80,443,8080,8443 -sV --script "http-enum,http-methods,http-headers,http-vuln*" -oN nmap/http.txt TARGET
sudo nmap -p443,8443 -sV --script "ssl-enum-ciphers,ssl-cert,ssl-heartbleed" -oN nmap/ssl.txt TARGET

# 4) Optional CVE mapping (if vulners.nse is installed)
sudo nmap -sV --script vulners --script-args vulners.mincvss=7.0 -oN nmap/vulners.txt TARGET

# 5) Script hygiene
nmap --script-help vuln
sudo nmap --script-updatedb
```

# Summary
This session focuses on leveraging Nmap’s Scripting Engine to quickly surface potential vulnerabilities as part of your enumeration workflow. The key pattern is: identify services (-sV), run default scripts (-sC), then apply the vuln category broadly and refine with targeted service scripts. Use script help to understand arguments and risk, save your outputs, and treat NSE results as leads to validate. Optional add‑ons like vulners.nse can map discovered versions to CVEs to speed triage for eJPT-style assessments.