# What the video covers (Introduction / big picture)
Note: No transcript was provided. The following is a conservative, context-based summary inferred from the filename and folder (01-VulnerabilityScanning/01 - Banner Grabbing.mp4).

The video introduces banner grabbing: actively connecting to network services to elicit and read the initial “banner” or protocol handshake that often reveals service name, version, and sometimes the underlying OS. This is foundational for vulnerability scanning because:
- Banners help you identify exact versions to map to CVEs.
- They guide deeper enumeration, exploitation choices, and false-positive reduction.
- Both automated (Nmap) and manual (nc/openssl/curl) techniques are used.

Key idea: verify and enrich Nmap -sV results with manual grabs; don’t fully trust banners as they can be sanitized or misleading.

# Flow (ordered)
1) Discover open ports on the target.
2) Identify services and versions with Nmap’s service detection.
3) Manually grab banners from key ports (HTTP/HTTPS, SSH, FTP, SMTP, SMB, DBs, etc.).
4) Use protocol-appropriate probes (e.g., HTTP HEAD, SMTP EHLO, Redis INFO).
5) Extract and record version strings, server headers, certificates, OS clues.
6) Cross-check versions against known vulnerabilities.
7) Document everything for the assessment report.

# Tools highlighted
- Nmap (port scan, -sV, NSE scripts like banner, http-title, smb-os-discovery)
- Netcat (nc) / Ncat (ncat) for raw TCP/UDP connections
- Curl for HTTP(S) headers
- OpenSSL s_client for TLS/SSL endpoints and certs
- Dig for DNS CHAOS class version.bind
- SNMP tools: snmpwalk/snmpget
- SMB tools: smbclient, nmblookup
- Service clients where applicable (redis-cli, mysql, psql), or minimal probes

# Typical command walkthrough (detailed, copy-paste friendly)
Set target variables to speed up copy/paste.
```bash
TARGET=10.10.10.10
DOMAIN=example.com     # Use if virtual hosting/SNI is needed; otherwise leave as IP
```

1) Quick discovery and service detection
```bash
# Fast host discovery (optional)
nmap -sn $TARGET

# TCP full port scan (adjust T4/T3 for stealth vs speed)
sudo nmap -p- -T4 -Pn $TARGET -oA scans/${TARGET}_full_tcp

# Extract open TCP ports (comma-separated) for follow-up
PORTS=$(grep -oP '^\d+/tcp\s+open' scans/${TARGET}_full_tcp.nmap | cut -d/ -f1 | paste -sd,)

# Service/version detection with default scripts on discovered ports
sudo nmap -sV -sC -p$PORTS -T4 -Pn $TARGET -oA scans/${TARGET}_svc

# UDP top ports (often catches SNMP/DNS/etc.)
sudo nmap -sU --top-ports 50 -sV -T4 -Pn $TARGET -oA scans/${TARGET}_top_udp
```

2) Nmap banner-focused scripts and deeper versioning
```bash
# Force aggressive version detection and show probe details
sudo nmap -sV --version-all --version-trace -p$PORTS -Pn $TARGET -oA scans/${TARGET}_vertrace

# Generic banner script across TCP
nmap --script banner -p$PORTS -Pn $TARGET -oN scans/${TARGET}_banner.nmap
```

3) Manual banner grabbing (TCP)
- HTTP (port 80)
```bash
# HEAD request (HTTP/1.1 requires Host header)
printf 'HEAD / HTTP/1.1\r\nHost: %s\r\nConnection: close\r\n\r\n' "$TARGET" | nc -nv -w 3 $TARGET 80

# Using curl to get headers
curl -sI http://$TARGET/
```
- HTTPS (port 443)
```bash
# Grab TLS banner/cert; include -servername for SNI if needed
echo | openssl s_client -connect ${TARGET}:443 -servername ${DOMAIN} -showcerts 2>/dev/null | sed -n '1,50p'

# HTTPS headers (ignore cert warnings)
curl -skI https://$TARGET/
```
- SSH (port 22)
```bash
# The server usually prints "SSH-2.0-OpenSSH_8.x ..." on connect
nc -nv -w 3 $TARGET 22
# Or with Nmap NSE for details
nmap -sV -p22 --script=ssh2-enum-algos,ssh-hostkey $TARGET
```
- FTP (port 21)
```bash
nc -nv -w 3 $TARGET 21
# Nmap anonymous check
nmap -p21 --script=ftp-anon $TARGET
```
- SMTP (port 25)
```bash
printf 'EHLO test\r\nQUIT\r\n' | nc -nv -w 5 $TARGET 25
```
- POP3 (port 110) and IMAP (port 143)
```bash
# POP3
printf 'QUIT\r\n' | nc -nv -w 3 $TARGET 110

# IMAP (ask for capabilities)
printf '. CAPABILITY\r\nA1 LOGOUT\r\n' | nc -nv -w 3 $TARGET 143
```
- SMB/NetBIOS (ports 139/445)
```bash
# NetBIOS name query
nmblookup -A $TARGET

# List shares (no auth)
smbclient -L //$TARGET/ -N

# Nmap OS/domain info
nmap -p445 --script smb-os-discovery,smb2-security-mode,smb2-time $TARGET
```
- RDP (port 3389)
```bash
nmap -sV -p3389 --script rdp-ntlm-info,rdp-enum-encryption $TARGET
```
- MySQL (port 3306) and PostgreSQL (port 5432)
```bash
# Often the initial handshake leaks version
nc -nv -w 3 $TARGET 3306
nc -nv -w 3 $TARGET 5432

# Nmap service/version if handshake is opaque
nmap -sV -p3306,5432 $TARGET
```
- Redis (port 6379)
```bash
# Redis INFO without auth (many CTF/weak setups)
printf 'INFO\r\n' | nc -nv -w 3 $TARGET 6379
```
- Memcached (port 11211)
```bash
printf 'stats\r\n' | nc -nv -w 3 $TARGET 11211
```
- VNC (port 5900)
```bash
nmap -sV -p5900 --script vnc-info $TARGET
```

4) Manual banner grabbing (UDP)
- DNS CHAOS version (port 53)
```bash
dig @${TARGET} CHAOS TXT version.bind +short
# Alternative:
dig @${TARGET} -p 53 version.bind txt chaos
```
- SNMP system info (port 161, common community string)
```bash
snmpwalk -v2c -c public $TARGET 1.3.6.1.2.1.1
# Or specific OID for sysDescr.0
snmpget -v2c -c public $TARGET 1.3.6.1.2.1.1.1.0
```
- TFTP (port 69)
```bash
nmap -sU -p69 --script tftp-enum $TARGET
```

5) HTTP-specific enrichment
```bash
# Page title and server header
nmap -p80,443 --script http-title,http-server-header $TARGET

# Follow redirects, print headers
curl -sI -L http://$TARGET/

# If virtual hosting suspected, specify Host:
curl -sI -H "Host: $DOMAIN" http://$TARGET/
```

6) TLS/SSL enrichment
```bash
# Enumerate ciphers/protocols
nmap -p443 --script ssl-enum-ciphers $TARGET

# Extract cert subject/issuer/dates quickly
echo | openssl s_client -connect ${TARGET}:443 -servername ${DOMAIN} 2>/dev/null | openssl x509 -noout -subject -issuer -dates
```

7) Save and organize outputs
```bash
mkdir -p notes/${TARGET}
nmap -sV -sC -p$PORTS -oN notes/${TARGET}/nmap_svc.txt $TARGET
curl -sI http://$TARGET/ | tee notes/${TARGET}/http_headers.txt
echo | openssl s_client -connect ${TARGET}:443 -servername ${DOMAIN} 2>/dev/null | tee notes/${TARGET}/tls_raw.txt
```

# Practical tips
- Don’t trust banners blindly. Services can hide or spoof them; confirm via multiple sources (Nmap probes, manual grabs, certs, protocol features).
- Use correct line endings. Many text protocols need CRLF. nc with printf and \r\n avoids parsing issues; nc -C (OpenBSD netcat) can help for HTTP.
- Set short timeouts (-w 3) to avoid hanging connections during manual grabs.
- For HTTPS behind virtual hosting, provide SNI (-servername with openssl; Host header with curl) to receive the correct certificate and response.
- Prioritize high-signal ports for manual grabs: 22, 21, 25, 80/443, 110/143, 139/445, 3306, 5432, 6379, 5900, 3389, 53/161 (UDP).
- Use NSE scripts that reveal OS/domain info: smb-os-discovery, rdp-ntlm-info, ssl-enum-ciphers, http-title, http-server-header.
- Document exact version strings and headers verbatim; they are invaluable for CVE mapping and replication.
- If a service is uncooperative, try different probes: Nmap --version-all, specific NSE scripts, or send a protocol-appropriate first line (e.g., Redis INFO, Memcached stats).

# Minimal cheat sheet (one-screen flow)
```bash
TARGET=10.10.10.10; DOMAIN=example.com

# 1) Find ports and services
sudo nmap -p- -T4 -Pn $TARGET -oA scans/${TARGET}_full_tcp
PORTS=$(grep -oP '^\d+/tcp\s+open' scans/${TARGET}_full_tcp.nmap | cut -d/ -f1 | paste -sd,)
sudo nmap -sV -sC -p$PORTS -T4 -Pn $TARGET -oA scans/${TARGET}_svc
sudo nmap -sU --top-ports 50 -sV -T4 -Pn $TARGET -oA scans/${TARGET}_top_udp

# 2) Quick manual banners
nc -nv -w 3 $TARGET 22
printf 'HEAD / HTTP/1.1\r\nHost: %s\r\nConnection: close\r\n\r\n' "$TARGET" | nc -nv -w 3 $TARGET 80
curl -skI https://$TARGET/
echo | openssl s_client -connect ${TARGET}:443 -servername ${DOMAIN} 2>/dev/null | sed -n '1,20p'
nc -nv -w 3 $TARGET 21
printf 'EHLO test\r\nQUIT\r\n' | nc -nv -w 5 $TARGET 25
nmblookup -A $TARGET; smbclient -L //$TARGET/ -N
printf 'INFO\r\n' | nc -nv -w 3 $TARGET 6379
nc -nv -w 3 $TARGET 3306
dig @${TARGET} CHAOS TXT version.bind +short
snmpwalk -v2c -c public $TARGET 1.3.6.1.2.1.1

# 3) Helpful NSE
nmap --script banner -p$PORTS -Pn $TARGET
nmap -p80,443 --script http-title,http-server-header $TARGET
nmap -p445 --script smb-os-discovery $TARGET
nmap -p3389 --script rdp-ntlm-info,rdp-enum-encryption $TARGET
nmap -p443 --script ssl-enum-ciphers $TARGET
```

# Summary
This video (inferred) demonstrates banner grabbing as a core part of vulnerability scanning in eJPT workflows. You:
- Scan for open ports and identify services with Nmap.
- Manually connect with nc/curl/openssl to elicit protocol greetings, headers, and certificates.
- Use protocol-specific probes and NSE scripts to enrich or validate banners.
- Record precise version strings and headers to guide vulnerability research and exploitation.
Always corroborate banners with multiple techniques, and treat them as leads rather than absolute truth.